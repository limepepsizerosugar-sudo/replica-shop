<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>명동사</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Gothic+A1:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --black: #111111;
            --white: #ffffff;
            --gray-50: #f9f9f9;
            --gray-100: #f5f5f5;
            --gray-200: #e8e8e8;
            --gray-300: #d5d5d5;
            --gray-400: #a0a0a0;
            --gray-500: #777777;
            --gray-600: #555555;
            --gray-700: #333333;
            --red: #e53935;
            --green: #43a047;
        }
        
        body { 
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--black);
            background: var(--white);
            line-height: 1.6;
            font-size: 14px;
        }
        
        a { text-decoration: none; color: inherit; }
        button { font-family: inherit; cursor: pointer; border: none; background: none; }
        input, select, textarea { font-family: inherit; }
        
        /* Loading */
        .loading-screen {
            position: fixed;
            inset: 0;
            background: var(--white);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        
        .loading-logo {
            font-family: 'Gothic A1', sans-serif;
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 25px;
            letter-spacing: -1px;
        }
        
        .loading-spinner {
            width: 30px;
            height: 30px;
            border: 2px solid var(--gray-200);
            border-top-color: var(--black);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Floating Messenger Buttons */
        .floating-btns {
            position: fixed;
            bottom: 30px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .floating-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
            border: none;
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }
        
        .floating-btn.kakao {
            background: #FEE500;
        }
        
        .floating-btn.telegram {
            background: #0088cc;
        }
        
        .floating-btn svg {
            width: 34px;
            height: 34px;
        }
        
        .floating-btn.kakao svg {
            fill: #391B1B;
        }
        
        .floating-btn.telegram svg {
            fill: #ffffff;
        }
        
        @media (max-width: 768px) {
            .floating-btns {
                bottom: 20px;
                right: 15px;
                gap: 10px;
            }
            .floating-btn {
                width: 56px;
                height: 56px;
            }
            .floating-btn svg {
                width: 30px;
                height: 30px;
            }
        }
        
        /* CS CENTER Pages */
        .cs-page {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .cs-header {
            text-align: center;
            padding: 50px 0 30px;
            border-bottom: 2px solid var(--black);
        }
        
        .cs-header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .cs-header p {
            font-size: 14px;
            color: var(--gray-500);
        }
        
        .cs-content {
            padding: 30px 0 80px;
        }
        
        .cs-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--gray-500);
        }
        
        /* Q&A */
        .qna-list { }
        
        .qna-item {
            border: 1px solid var(--gray-200);
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .qna-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .qna-status {
            padding: 4px 10px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .qna-status.waiting {
            background: #fff8e1;
            color: #f9a825;
        }
        
        .qna-status.answered {
            background: #e8f5e9;
            color: #43a047;
        }
        
        .qna-date {
            font-size: 12px;
            color: var(--gray-400);
        }
        
        .qna-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .qna-content {
            font-size: 14px;
            color: var(--gray-600);
            line-height: 1.6;
        }
        
        .qna-answer {
            margin-top: 15px;
            padding: 15px;
            background: var(--gray-50);
            border-left: 3px solid var(--black);
        }
        
        .qna-answer strong {
            display: block;
            font-size: 12px;
            color: var(--gray-500);
            margin-bottom: 8px;
        }
        
        .qna-answer p {
            font-size: 14px;
            color: var(--gray-700);
            line-height: 1.6;
        }
        
        /* Review */
        .review-list { }
        
        .review-item {
            border-bottom: 1px solid var(--gray-200);
            padding: 25px 0;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .review-rating {
            color: #f9a825;
            font-size: 14px;
        }
        
        .review-date {
            font-size: 12px;
            color: var(--gray-400);
        }
        
        .review-product {
            font-size: 12px;
            color: var(--gray-500);
            margin-bottom: 8px;
        }
        
        .review-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .review-content {
            font-size: 14px;
            color: var(--gray-600);
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .review-author {
            font-size: 13px;
            color: var(--gray-500);
        }
        
        .rating-select {
            display: flex;
            gap: 5px;
        }
        
        .rating-star {
            font-size: 24px;
            color: var(--gray-300);
            cursor: pointer;
        }
        
        .rating-star.active {
            color: #f9a825;
        }
        
        /* FAQ */
        .faq-list { }
        
        .faq-item {
            border-bottom: 1px solid var(--gray-200);
        }
        
        .faq-question {
            display: flex;
            align-items: center;
            padding: 18px 0;
            cursor: pointer;
        }
        
        .faq-q, .faq-a {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .faq-q {
            background: var(--black);
            color: var(--white);
        }
        
        .faq-a {
            background: var(--gray-200);
            color: var(--gray-600);
        }
        
        .faq-title {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }
        
        .faq-arrow {
            font-size: 20px;
            color: var(--gray-400);
        }
        
        .faq-answer {
            display: flex;
            padding: 0 0 20px;
            margin-left: 43px;
        }
        
        .faq-answer p {
            font-size: 14px;
            color: var(--gray-600);
            line-height: 1.7;
        }
        
        /* Info Page */
        .info-content {
            font-size: 14px;
            line-height: 1.8;
            color: var(--gray-600);
        }
        
        .info-content h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--black);
            margin: 30px 0 15px;
        }
        
        .info-content h3:first-child {
            margin-top: 0;
        }
        
        .info-content p {
            margin-bottom: 15px;
        }
        
        /* Search */
        .header-search {
            flex: 1;
            max-width: 350px;
            margin: 0 30px;
            position: relative;
        }
        .header-search input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border: 1px solid var(--gray-300);
            font-size: 13px;
        }
        .header-search input:focus {
            outline: none;
            border-color: var(--black);
        }
        .header-search button {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            background: none;
            border: none;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .header-search { display: none; }
        }
        
        /* Recent Viewed */
        .recent-viewed {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-right: none;
            z-index: 100;
            width: 75px;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
        }
        .recent-viewed-title {
            padding: 10px 5px;
            text-align: center;
            font-size: 10px;
            font-weight: 600;
            background: var(--gray-100);
            border-bottom: 1px solid var(--gray-200);
        }
        .recent-viewed-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .recent-viewed-item {
            padding: 5px;
            border-bottom: 1px solid var(--gray-100);
            cursor: pointer;
        }
        .recent-viewed-item img {
            width: 100%;
            aspect-ratio: 1/1.2;
            object-fit: cover;
        }
        
        @media (max-width: 768px) {
            .recent-viewed { display: none; }
        }
        
        /* Notice */
        .notice-list { }
        .notice-item {
            border-bottom: 1px solid var(--gray-200);
            padding: 18px 0;
            cursor: pointer;
        }
        .notice-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .notice-badge {
            padding: 3px 8px;
            font-size: 11px;
            font-weight: 600;
        }
        .notice-badge.important { background: var(--red); color: var(--white); }
        .notice-badge.normal { background: var(--gray-200); color: var(--gray-600); }
        .notice-title { font-size: 14px; font-weight: 500; }
        .notice-date { font-size: 12px; color: var(--gray-400); margin-top: 8px; }
        .notice-content {
            padding: 15px;
            background: var(--gray-50);
            margin-top: 12px;
            font-size: 14px;
            line-height: 1.7;
            white-space: pre-wrap;
        }
        
        /* Event */
        .event-list {
            display: grid;
            gap: 30px;
        }
        .event-item {
            cursor: pointer;
        }
        .event-image {
            width: 100%;
            aspect-ratio: 2/1;
            object-fit: cover;
            margin-bottom: 15px;
        }
        .event-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .event-period {
            font-size: 13px;
            color: var(--gray-500);
        }
        
        /* Grade Badge */
        .grade-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 5px;
        }
        .grade-vip { background: linear-gradient(135deg, #ffd700, #ffb700); color: #000; }
        .grade-gold { background: linear-gradient(135deg, #ffc107, #ff9800); color: #000; }
        .grade-silver { background: linear-gradient(135deg, #bdbdbd, #9e9e9e); color: #fff; }
        .grade-bronze { background: linear-gradient(135deg, #cd7f32, #a0522d); color: #fff; }
        
        /* Points */
        .points-card {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: var(--white);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        .points-label { font-size: 13px; opacity: 0.9; margin-bottom: 5px; }
        .points-value { font-size: 32px; font-weight: 700; }
        .points-history { border: 1px solid var(--gray-200); }
        .points-history-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid var(--gray-200);
            font-size: 13px;
        }
        .points-history-item:last-child { border-bottom: none; }
        .points-plus { color: #1976d2; font-weight: 600; }
        .points-minus { color: var(--red); font-weight: 600; }
        
        /* Coupon */
        .coupon-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--white);
            padding: 20px;
            border-radius: 8px;
        }
        .coupon-title { font-size: 14px; margin-bottom: 8px; opacity: 0.9; }
        .coupon-value { font-size: 24px; font-weight: 700; margin-bottom: 5px; }
        .coupon-desc { font-size: 12px; opacity: 0.8; }
        .coupon-download {
            margin-top: 12px;
            padding: 8px 16px;
            background: var(--white);
            color: #667eea;
            border: none;
            font-size: 12px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
        }
        .coupon-card {
            border: 2px dashed var(--gray-300);
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .coupon-card.used { opacity: 0.5; }
        .coupon-info h4 { font-size: 15px; font-weight: 600; margin-bottom: 5px; }
        .coupon-info p { font-size: 13px; color: var(--gray-500); }
        .coupon-amount { font-size: 22px; font-weight: 700; color: var(--red); }
        
        /* Stock */
        .product-stock { font-size: 11px; color: #f57c00; margin-top: 4px; }
        .detail-stock {
            padding: 10px 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 13px;
        }
        .detail-stock.low { background: #fff3e0; color: #f57c00; }
        .detail-stock.out { background: #ffebee; color: var(--red); }
        .detail-stock.in { background: #e8f5e9; color: #43a047; }
        
        /* Restock Alert */
        .restock-btn {
            width: 100%;
            padding: 12px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            font-size: 13px;
            margin-bottom: 15px;
            cursor: pointer;
        }
        .restock-btn:hover { background: var(--gray-200); }
        .restock-btn.active { background: #1976d2; color: var(--white); border-color: #1976d2; }
        
        /* Popup */
        .popup-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
        }
        
        .popup-container {
            position: relative;
            max-width: 400px;
            width: 100%;
            background: var(--white);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .popup-image {
            width: 100%;
            display: block;
            cursor: pointer;
        }
        
        .popup-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            background: rgba(0,0,0,0.5);
            color: var(--white);
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .popup-close:hover {
            background: rgba(0,0,0,0.7);
        }
        
        .popup-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: var(--gray-100);
            font-size: 13px;
        }
        
        .popup-today {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            color: var(--gray-600);
        }
        
        .popup-today input {
            cursor: pointer;
        }
        
        .popup-close-btn {
            background: none;
            border: none;
            font-size: 13px;
            color: var(--gray-600);
            cursor: pointer;
        }
        
        .popup-close-btn:hover {
            color: var(--black);
        }
        
        @media (max-width: 768px) {
            .popup-container {
                max-width: 320px;
            }
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--black);
            color: var(--white);
            padding: 14px 28px;
            border-radius: 4px;
            font-size: 13px;
            z-index: 9999;
            animation: fadeUp 0.3s ease;
        }
        .toast.error { background: var(--red); }
        .toast.success { background: var(--black); }
        
        @keyframes fadeUp {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
        
        /* Header - wizwid style */
        .header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: var(--white);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .header-top {
            background: var(--black);
            color: var(--white);
            text-align: center;
            padding: 8px;
            font-size: 12px;
        }
        
        .header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            font-family: 'Gothic A1', sans-serif;
            font-size: 26px;
            font-weight: 900;
            letter-spacing: -1px;
            cursor: pointer;
        }
        
        .nav-menu { 
            display: flex; 
            gap: 40px;
        }
        
        .nav-link {
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-700);
            cursor: pointer;
            padding: 8px 0;
            position: relative;
            transition: color 0.2s;
        }
        
        .nav-link:hover { color: var(--black); }
        
        .nav-link.active {
            color: var(--black);
            font-weight: 600;
        }
        
        .header-actions { 
            display: flex; 
            gap: 24px; 
            align-items: center;
            font-size: 13px;
            color: var(--gray-600);
        }
        
        .header-action {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.2s;
        }
        
        .header-action:hover { color: var(--black); }
        
        .header-action .count {
            background: var(--red);
            color: white;
            font-size: 10px;
            padding: 2px 5px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        /* Main Visual Slider */
        .main-slider {
            position: relative;
            height: 500px;
            overflow: hidden;
        }
        
        .slider-track {
            display: flex;
            height: 100%;
            transition: transform 0.5s ease;
        }
        
        .slider-slide {
            min-width: 100%;
            height: 100%;
            position: relative;
        }
        
        .slider-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .slider-slide::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.1) 60%);
        }
        
        .slider-content {
            position: absolute;
            bottom: 80px;
            left: 60px;
            z-index: 2;
            color: var(--white);
        }
        
        .slider-subtitle {
            font-size: 13px;
            letter-spacing: 2px;
            margin-bottom: 12px;
            opacity: 0.9;
        }
        
        .slider-title {
            font-family: 'Gothic A1', sans-serif;
            font-size: 42px;
            font-weight: 900;
            line-height: 1.2;
            margin-bottom: 25px;
        }
        
        .slider-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.9);
            border: none;
            cursor: pointer;
            font-size: 20px;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .slider-arrow:hover {
            background: var(--white);
        }
        
        .slider-arrow.prev { left: 20px; }
        .slider-arrow.next { right: 20px; }
        
        .slider-dots {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .slider-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }
        
        .slider-dot.active {
            background: var(--white);
            width: 30px;
            border-radius: 5px;
        }
        
        .btn-white {
            display: inline-block;
            padding: 14px 32px;
            background: var(--white);
            color: var(--black);
            font-size: 13px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-white:hover {
            background: var(--black);
            color: var(--white);
        }
        
        /* Section */
        .section {
            padding: 60px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
        }
        
        .section-more {
            font-size: 13px;
            color: var(--gray-500);
            cursor: pointer;
        }
        
        .section-more:hover { color: var(--black); }
        
        /* Product Grid - wizwid style (5열) */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }
        
        .product-grid.list-view {
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }
        
        .product-card { 
            cursor: pointer;
            position: relative;
        }
        
        .product-image {
            position: relative;
            aspect-ratio: 1/1.2;
            background: var(--gray-100);
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        
        .product-card:hover .product-image img { 
            transform: scale(1.03); 
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--red);
            color: var(--white);
            padding: 4px 8px;
            font-size: 10px;
            font-weight: 600;
        }
        
        .product-wishlist {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
            cursor: pointer;
            border: none;
            font-size: 14px;
        }
        
        .product-card:hover .product-wishlist { opacity: 1; }
        .product-wishlist.active { opacity: 1; color: var(--red); }
        
        .product-brand { 
            font-size: 11px; 
            color: var(--gray-500);
            margin-bottom: 3px;
            font-weight: 500;
        }
        
        .product-name { 
            font-size: 12px; 
            color: var(--gray-700);
            margin-bottom: 6px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .product-price { 
            font-size: 13px; 
            font-weight: 700;
        }
        
        .product-price .original { 
            color: var(--gray-400); 
            text-decoration: line-through; 
            font-weight: 400;
            font-size: 11px;
            margin-right: 5px;
        }
        
        .product-price .sale { color: var(--red); }
        
        .product-price .discount {
            color: var(--red);
            font-size: 12px;
            margin-left: 6px;
        }
        
        /* Category Banner */
        .category-banners {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            padding: 0 40px;
            max-width: 1400px;
            margin: 50px auto 60px;
        }
        
        .category-banner {
            position: relative;
            aspect-ratio: 1/1;
            overflow: hidden;
            cursor: pointer;
        }
        
        .category-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s;
        }
        
        .category-banner:hover img { transform: scale(1.05); }
        
        .category-banner::after {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.2);
        }
        
        .category-banner-content {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 1;
            color: var(--white);
        }
        
        .category-banner-name {
            font-size: 18px;
            font-weight: 700;
        }
        
        /* List Page Header - wizwid style */
        .list-header {
            padding: 40px 40px 0;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .list-breadcrumb {
            font-size: 12px;
            color: var(--gray-400);
            margin-bottom: 20px;
        }
        
        .list-breadcrumb span { margin: 0 6px; }
        
        .list-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 30px;
        }
        
        .list-filter {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-top: 1px solid var(--gray-200);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .list-count {
            font-size: 13px;
            color: var(--gray-500);
        }
        
        .list-count strong { color: var(--black); }
        
        .list-sort select {
            padding: 8px 12px;
            border: 1px solid var(--gray-300);
            font-size: 13px;
            background: var(--white);
        }
        
        /* Detail Page - wizwid style */
        .detail-wrap {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }
        
        .detail-container {
            display: grid;
            grid-template-columns: 520px 1fr;
            gap: 60px;
        }
        
        .detail-images {
            position: sticky;
            top: 100px;
        }
        
        .detail-main-image {
            width: 100%;
            aspect-ratio: 1/1.2;
            background: var(--gray-100);
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .detail-main-image img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        
        .detail-thumbs {
            display: flex;
            gap: 8px;
        }
        
        .detail-thumb {
            width: 60px;
            height: 75px;
            background: var(--gray-100);
            cursor: pointer;
            border: 2px solid transparent;
            overflow: hidden;
        }
        
        .detail-thumb.active { border-color: var(--black); }
        .detail-thumb img { width: 100%; height: 100%; object-fit: cover; }
        
        .detail-info {
            padding-top: 10px;
        }
        
        .detail-brand {
            font-size: 13px;
            color: var(--gray-500);
            margin-bottom: 8px;
        }
        
        .detail-name {
            font-size: 22px;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 20px;
            color: var(--gray-700);
        }
        
        .detail-price-wrap {
            padding: 20px 0;
            border-top: 1px solid var(--gray-200);
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: 25px;
        }
        
        .detail-original-price {
            font-size: 14px;
            color: var(--gray-400);
            text-decoration: line-through;
            margin-bottom: 5px;
        }
        
        .detail-sale-price {
            font-size: 26px;
            font-weight: 700;
        }
        
        .detail-sale-price .discount {
            color: var(--red);
            margin-left: 10px;
            font-size: 20px;
        }
        
        .detail-shipping {
            font-size: 13px;
            color: var(--gray-600);
            margin-bottom: 25px;
            padding: 15px;
            background: var(--gray-50);
        }
        
        .detail-shipping strong {
            color: var(--black);
            margin-right: 10px;
        }
        
        .option-section {
            margin-bottom: 20px;
        }
        
        .option-label {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
        }
        
        .option-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-300);
            font-size: 14px;
            background: var(--white);
            cursor: pointer;
        }
        
        .option-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .option-btn {
            padding: 10px 18px;
            border: 1px solid var(--gray-300);
            background: var(--white);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .option-btn:hover { border-color: var(--gray-600); }
        .option-btn.active { 
            border-color: var(--black); 
            background: var(--black); 
            color: var(--white); 
        }
        
        .detail-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }
        
        .btn-cart, .btn-buy {
            flex: 1;
            padding: 16px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s;
        }
        
        .btn-cart {
            background: var(--white);
            border: 1px solid var(--black);
            color: var(--black);
        }
        
        .btn-cart:hover { background: var(--gray-100); }
        
        .btn-buy {
            background: var(--black);
            border: 1px solid var(--black);
            color: var(--white);
        }
        
        .btn-buy:hover { background: var(--gray-700); }
        
        .btn-wish {
            width: 52px;
            height: 52px;
            border: 1px solid var(--gray-300);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
        }
        
        .btn-wish:hover { border-color: var(--gray-600); }
        .btn-wish.active { color: var(--red); border-color: var(--red); }
        
        /* Detail Description */
        .detail-desc-section {
            max-width: 1200px;
            margin: 60px auto;
            padding: 0 40px;
        }
        
        .detail-desc-tabs {
            display: flex;
            border-bottom: 2px solid var(--black);
        }
        
        .detail-desc-tab {
            padding: 15px 30px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            color: var(--gray-500);
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            border-bottom: none;
            margin-right: -1px;
        }
        
        .detail-desc-tab.active {
            background: var(--white);
            color: var(--black);
            border-color: var(--black);
            border-bottom: 2px solid var(--white);
            margin-bottom: -2px;
        }
        
        .detail-desc-content {
            padding: 40px 0;
            font-size: 14px;
            line-height: 1.8;
            color: var(--gray-600);
        }
        
        .detail-desc-content img {
            max-width: 100%;
            display: block;
            margin: 20px auto;
        }
        
        /* Footer - wizwid style */
        .footer {
            background: var(--gray-100);
            padding: 50px 40px;
            margin-top: 80px;
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
        }
        
        .footer-brand {
            font-family: 'Gothic A1', sans-serif;
            font-size: 22px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .footer-desc { 
            font-size: 13px; 
            color: var(--gray-500); 
            line-height: 1.7; 
        }
        
        .footer-title { 
            font-size: 13px; 
            font-weight: 700; 
            margin-bottom: 15px; 
        }
        
        .footer-links { list-style: none; }
        
        .footer-links li { 
            margin-bottom: 10px; 
            font-size: 13px; 
            color: var(--gray-500); 
            cursor: pointer; 
        }
        
        .footer-links li:hover { color: var(--black); }
        
        .footer-bottom {
            max-width: 1400px;
            margin: 30px auto 0;
            padding-top: 20px;
            border-top: 1px solid var(--gray-300);
            font-size: 11px;
            color: var(--gray-400);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .footer-bottom {
                flex-direction: column;
                text-align: center;
                font-size: 10px;
            }
        }
        
        /* Auth Page */
        .auth-page {
            min-height: calc(100vh - 200px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
        }
        
        .auth-container {
            width: 100%;
            max-width: 400px;
        }
        
        .auth-title {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-group { margin-bottom: 15px; }
        
        .form-label { 
            display: block; 
            font-size: 13px; 
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--gray-600);
        }
        
        .form-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--gray-300);
            font-size: 14px;
        }
        
        .form-input:focus { 
            outline: none; 
            border-color: var(--black); 
        }
        
        .btn-submit {
            width: 100%;
            padding: 14px;
            background: var(--black);
            color: var(--white);
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .btn-submit:hover { background: var(--gray-700); }
        .btn-submit:disabled { background: var(--gray-400); cursor: not-allowed; }
        
        .auth-link { 
            text-align: center; 
            margin-top: 20px; 
            font-size: 13px; 
            color: var(--gray-500); 
        }
        
        .auth-link a { 
            color: var(--black); 
            font-weight: 600; 
            cursor: pointer;
            text-decoration: underline;
        }
        
        .auth-error {
            background: #ffebee;
            color: var(--red);
            padding: 12px;
            margin-bottom: 15px;
            font-size: 13px;
            text-align: center;
        }
        
        /* Cart Page */
        .cart-wrap {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
        }
        
        .cart-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .cart-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 40px;
        }
        
        .cart-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .cart-table th {
            padding: 15px;
            background: var(--gray-100);
            font-size: 13px;
            font-weight: 600;
            text-align: center;
            border-top: 2px solid var(--black);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .cart-table td {
            padding: 20px 15px;
            border-bottom: 1px solid var(--gray-200);
            text-align: center;
            vertical-align: middle;
        }
        
        .cart-product {
            display: flex;
            align-items: center;
            gap: 15px;
            text-align: left;
        }
        
        .cart-product-img {
            width: 80px;
            height: 100px;
            background: var(--gray-100);
            overflow: hidden;
        }
        
        .cart-product-img img { width: 100%; height: 100%; object-fit: cover; }
        
        .cart-product-brand { font-size: 12px; color: var(--gray-500); margin-bottom: 4px; }
        .cart-product-name { font-size: 13px; color: var(--gray-700); margin-bottom: 6px; }
        .cart-product-option { font-size: 12px; color: var(--gray-400); }
        
        .cart-qty {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .cart-qty button {
            width: 26px;
            height: 26px;
            border: 1px solid var(--gray-300);
            background: var(--white);
            cursor: pointer;
            font-size: 14px;
        }
        
        .cart-remove {
            font-size: 12px;
            color: var(--gray-400);
            cursor: pointer;
            text-decoration: underline;
        }
        
        .cart-summary {
            background: var(--gray-50);
            padding: 30px;
            border: 1px solid var(--gray-200);
            position: sticky;
            top: 100px;
        }
        
        .cart-summary h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .cart-summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
            color: var(--gray-600);
        }
        
        .cart-summary-total {
            display: flex;
            justify-content: space-between;
            padding-top: 15px;
            margin-top: 15px;
            border-top: 2px solid var(--black);
            font-size: 18px;
            font-weight: 700;
        }
        
        .cart-summary .btn-buy {
            width: 100%;
            margin-top: 20px;
        }
        
        /* My Page */
        .mypage-wrap {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
        }
        
        .mypage-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
        }
        
        .mypage-layout {
            display: grid;
            grid-template-columns: 180px 1fr;
            gap: 40px;
        }
        
        .mypage-nav { border-right: 1px solid var(--gray-200); }
        
        .mypage-nav-item {
            padding: 12px 0;
            font-size: 14px;
            cursor: pointer;
            color: var(--gray-500);
        }
        
        .mypage-nav-item:hover { color: var(--black); }
        .mypage-nav-item.active { color: var(--black); font-weight: 600; }
        
        .mypage-content h2 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--black);
        }
        
        .order-item {
            border: 1px solid var(--gray-200);
            margin-bottom: 15px;
        }
        
        .order-item-header {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: var(--gray-50);
            font-size: 13px;
        }
        
        .order-item-body {
            padding: 20px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pending { background: #fff8e1; color: #f9a825; }
        .status-confirmed { background: #e3f2fd; color: #1976d2; }
        .status-shipped { background: #e8f5e9; color: #43a047; }
        .status-completed { background: var(--gray-200); color: var(--gray-600); }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-500);
        }
        
        .empty-state h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--gray-700);
        }
        
        /* Admin */
        .admin-layout { display: flex; min-height: 100vh; }
        
        .admin-sidebar {
            width: 220px;
            background: var(--gray-700);
            color: var(--white);
            padding: 20px 0;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
        }
        
        .admin-logo {
            font-family: 'Gothic A1', sans-serif;
            font-size: 20px;
            font-weight: 900;
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }
        
        .admin-logo span { display: block; font-size: 11px; font-weight: 400; opacity: 0.5; margin-top: 4px; }
        .admin-nav { list-style: none; }
        
        .admin-nav-item {
            padding: 12px 20px;
            font-size: 13px;
            cursor: pointer;
            color: rgba(255,255,255,0.7);
        }
        
        .admin-nav-item:hover { background: rgba(255,255,255,0.05); color: var(--white); }
        .admin-nav-item.active { background: rgba(255,255,255,0.1); color: var(--white); }
        
        .admin-main {
            flex: 1;
            margin-left: 220px;
            background: var(--gray-50);
            min-height: 100vh;
        }
        
        .admin-header {
            background: var(--white);
            padding: 20px 30px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .admin-header h1 { font-size: 20px; font-weight: 700; }
        .admin-content { padding: 30px; }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--white);
            padding: 20px;
            border: 1px solid var(--gray-200);
        }
        
        .stat-card h3 { font-size: 12px; color: var(--gray-500); margin-bottom: 10px; }
        .stat-card .value { font-size: 28px; font-weight: 700; }
        
        .admin-table-wrap {
            background: var(--white);
            border: 1px solid var(--gray-200);
        }
        
        .admin-table-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-table-header h2 { font-size: 15px; font-weight: 700; }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .admin-table th {
            text-align: left;
            padding: 12px 15px;
            font-size: 12px;
            font-weight: 600;
            color: var(--gray-600);
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .admin-table td {
            padding: 15px;
            font-size: 13px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .admin-table tr:hover { background: var(--gray-50); }
        
        .admin-table img {
            width: 40px;
            height: 50px;
            object-fit: cover;
            background: var(--gray-100);
        }
        
        .btn-admin {
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
        }
        
        .btn-admin-primary { background: var(--black); color: var(--white); border: none; }
        .btn-admin-secondary { background: var(--white); color: var(--black); border: 1px solid var(--gray-300); }
        .btn-admin-danger { background: var(--red); color: var(--white); border: none; }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .modal {
            background: var(--white);
            width: 100%;
            max-width: 560px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 30px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .modal-header h2 { font-size: 18px; font-weight: 700; }
        .modal-close { font-size: 24px; cursor: pointer; color: var(--gray-400); }
        .modal-close:hover { color: var(--black); }
        
        .image-preview {
            max-width: 120px;
            max-height: 150px;
            object-fit: cover;
            border: 1px solid var(--gray-200);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .product-grid { grid-template-columns: repeat(4, 1fr); }
            .product-grid.list-view { grid-template-columns: repeat(4, 1fr); }
            .detail-container { grid-template-columns: 1fr 1fr; gap: 40px; }
        }
        
        @media (max-width: 1024px) {
            .product-grid { grid-template-columns: repeat(3, 1fr); }
            .product-grid.list-view { grid-template-columns: repeat(3, 1fr); }
            .category-banners { grid-template-columns: repeat(2, 1fr); }
            .detail-container { grid-template-columns: 1fr; }
            .cart-layout { grid-template-columns: 1fr; }
            .mypage-layout { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 768px) {
            .header-main { padding: 15px 20px; }
            .nav-menu { display: none; }
            .main-slider { height: 350px; }
            .slider-title { font-size: 28px; }
            .slider-content { left: 25px; bottom: 50px; }
            .slider-arrow { width: 36px; height: 36px; font-size: 16px; }
            .slider-arrow.prev { left: 10px; }
            .slider-arrow.next { right: 10px; }
            .section { padding: 40px 20px; }
            .product-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .product-grid.list-view { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .category-banners { grid-template-columns: 1fr 1fr; gap: 10px; padding: 0 20px; margin: 30px auto 40px; }
            .footer-content { grid-template-columns: 1fr; gap: 25px; }
            .admin-sidebar { display: none; }
            .admin-main { margin-left: 0; }
            
            /* 상세페이지 탭 모바일 */
            .detail-desc-tabs { 
                display: flex; 
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .detail-desc-tab { 
                padding: 12px 15px; 
                font-size: 12px; 
                white-space: nowrap;
                flex-shrink: 0;
            }
            .detail-wrap { padding: 20px; }
            .detail-container { gap: 30px; }
            .detail-name { font-size: 18px; }
            .detail-sale-price { font-size: 22px; }
            .detail-desc-section { padding: 0 20px; }
            .detail-actions { flex-wrap: wrap; }
            .btn-cart, .btn-buy { padding: 14px 10px; font-size: 13px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBiraK4MFYnXerJaiRAlTF7GtNoSWggyMM",
            authDomain: "replica-89a4d.firebaseapp.com",
            projectId: "replica-89a4d",
            storageBucket: "replica-89a4d.firebasestorage.app",
            messagingSenderId: "707110930733",
            appId: "1:707110930733:web:0663a763118b4522e22ba4"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        const ADMIN_EMAIL = 'admin@replica.com';
    </script>
    
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;
        
        const AppContext = createContext();
        
        const AppProvider = ({ children }) => {
            const [user, setUser] = useState(null);
            const [isAdmin, setIsAdmin] = useState(false);
            const [loading, setLoading] = useState(true);
            const [cart, setCart] = useState([]);
            const [wishlist, setWishlist] = useState([]);
            const [currentPage, setCurrentPage] = useState('home');
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [products, setProducts] = useState([]);
            const [orders, setOrders] = useState([]);
            const [allOrders, setAllOrders] = useState([]);
            const [members, setMembers] = useState([]);
            const [toast, setToast] = useState(null);
            const [buyNowItem, setBuyNowItem] = useState(null);
            const [qnas, setQnas] = useState([]);
            const [reviews, setReviews] = useState([]);
            const [faqs, setFaqs] = useState([]);
            const [siteInfo, setSiteInfo] = useState({ shipping: '', exchange: '' });
            const [popup, setPopup] = useState({
                active: true,
                image: '',
                link: 'new'
            });
            const [searchKeyword, setSearchKeyword] = useState('');
            const [coupons, setCoupons] = useState([]);
            const [myCoupons, setMyCoupons] = useState([]);
            const [userPoints, setUserPoints] = useState(0);
            const [pointsHistory, setPointsHistory] = useState([]);
            const [recentViewed, setRecentViewed] = useState([]);
            const [notices, setNotices] = useState([]);
            const [events, setEvents] = useState([]);
            const [restockAlerts, setRestockAlerts] = useState([]);
            
            // 회원 등급 계산
            const getGrade = (totalSpent) => {
                if (totalSpent >= 1000000) return { name: 'VIP', class: 'vip', pointRate: 5 };
                if (totalSpent >= 500000) return { name: 'GOLD', class: 'gold', pointRate: 3 };
                if (totalSpent >= 100000) return { name: 'SILVER', class: 'silver', pointRate: 2 };
                return { name: 'BRONZE', class: 'bronze', pointRate: 1 };
            };
            
            // 기본 팝업 이미지 (SVG)
            const defaultPopupImage = `data:image/svg+xml,${encodeURIComponent(`
                <svg xmlns="http://www.w3.org/2000/svg" width="400" height="500" viewBox="0 0 400 500">
                    <rect fill="#111" width="400" height="500"/>
                    <rect fill="#e53935" x="0" y="100" width="400" height="300"/>
                    <text x="200" y="60" text-anchor="middle" fill="#fff" font-family="Arial Black" font-size="24" font-weight="900">WINTER SALE</text>
                    <text x="200" y="220" text-anchor="middle" fill="#fff" font-family="Arial Black" font-size="120" font-weight="900">50%</text>
                    <text x="200" y="290" text-anchor="middle" fill="#fff" font-family="Arial Black" font-size="36" font-weight="900">OFF</text>
                    <text x="200" y="350" text-anchor="middle" fill="#fff" font-family="Arial" font-size="18">전 상품 최대 50% 할인</text>
                    <rect fill="#fff" x="120" y="420" width="160" height="45" rx="4"/>
                    <text x="200" y="450" text-anchor="middle" fill="#111" font-family="Arial Black" font-size="16" font-weight="900">SHOP NOW</text>
                </svg>
            `)}`;
            
            const showToast = (message, type = 'info') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };
            
            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged(async (firebaseUser) => {
                    if (firebaseUser) {
                        try {
                            const userDoc = await db.collection('users').doc(firebaseUser.uid).get();
                            let userData = userDoc.data();
                            
                            if (!userData) {
                                userData = {
                                    email: firebaseUser.email,
                                    name: firebaseUser.email.split('@')[0],
                                    phone: '',
                                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                    orderCount: 0,
                                    totalSpent: 0,
                                    wishlist: []
                                };
                                await db.collection('users').doc(firebaseUser.uid).set(userData);
                            }
                            
                            setUser({
                                uid: firebaseUser.uid,
                                email: firebaseUser.email,
                                name: userData?.name || firebaseUser.email.split('@')[0],
                                phone: userData?.phone || '',
                                totalSpent: userData?.totalSpent || 0
                            });
                            
                            setIsAdmin(firebaseUser.email === ADMIN_EMAIL);
                            setWishlist(userData?.wishlist || []);
                            setUserPoints(userData?.points || 0);
                            
                            const savedCart = localStorage.getItem(`cart_${firebaseUser.uid}`);
                            if (savedCart) setCart(JSON.parse(savedCart));
                            
                            const savedRecent = localStorage.getItem(`recent_${firebaseUser.uid}`);
                            if (savedRecent) setRecentViewed(JSON.parse(savedRecent));
                        } catch (error) {
                            console.error('Auth error:', error);
                            setUser({ uid: firebaseUser.uid, email: firebaseUser.email, name: firebaseUser.email.split('@')[0], phone: '', totalSpent: 0 });
                            setIsAdmin(firebaseUser.email === ADMIN_EMAIL);
                        }
                    } else {
                        setUser(null);
                        setIsAdmin(false);
                        setCart([]);
                        setWishlist([]);
                        setUserPoints(0);
                        setRecentViewed([]);
                    }
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);
            
            useEffect(() => {
                const unsubscribe = db.collection('products').orderBy('createdAt', 'desc')
                    .onSnapshot((snapshot) => {
                        setProducts(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                    });
                return () => unsubscribe();
            }, []);
            
            useEffect(() => {
                if (!user) { setOrders([]); return; }
                const unsubscribe = db.collection('orders').where('userId', '==', user.uid)
                    .onSnapshot((snapshot) => {
                        const list = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        list.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                        setOrders(list);
                    });
                return () => unsubscribe();
            }, [user]);
            
            useEffect(() => {
                if (!isAdmin) return;
                const ordersUnsub = db.collection('orders').onSnapshot((snapshot) => {
                    const list = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    list.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                    setAllOrders(list);
                });
                const membersUnsub = db.collection('users').onSnapshot((snapshot) => {
                    const list = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    list.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                    setMembers(list);
                });
                return () => { ordersUnsub(); membersUnsub(); };
            }, [isAdmin]);
            
            // Q&A (본인 것만 or 관리자는 전체)
            useEffect(() => {
                if (!user) { setQnas([]); return; }
                const query = isAdmin 
                    ? db.collection('qnas').orderBy('createdAt', 'desc')
                    : db.collection('qnas').where('userId', '==', user.uid).orderBy('createdAt', 'desc');
                const unsub = query.onSnapshot((snapshot) => {
                    setQnas(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => console.error('QnA error:', error));
                return () => unsub();
            }, [user, isAdmin]);
            
            // Reviews (전체 공개)
            useEffect(() => {
                const unsub = db.collection('reviews').orderBy('createdAt', 'desc').onSnapshot((snapshot) => {
                    setReviews(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });
                return () => unsub();
            }, []);
            
            // FAQs (전체 공개)
            useEffect(() => {
                const unsub = db.collection('faqs').orderBy('order', 'asc').onSnapshot((snapshot) => {
                    setFaqs(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });
                return () => unsub();
            }, []);
            
            // Site Info (배송안내, 교환/반품)
            useEffect(() => {
                const unsub = db.collection('siteInfo').doc('info').onSnapshot((doc) => {
                    if (doc.exists) setSiteInfo(doc.data());
                });
                return () => unsub();
            }, []);
            
            // Popup
            useEffect(() => {
                const unsub = db.collection('siteInfo').doc('popup').onSnapshot((doc) => {
                    if (doc.exists) setPopup(doc.data());
                });
                return () => unsub();
            }, []);
            
            // Coupons
            useEffect(() => {
                const unsub = db.collection('coupons').onSnapshot(snap => {
                    setCoupons(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => unsub();
            }, []);
            
            // My Coupons
            useEffect(() => {
                if (!user) { setMyCoupons([]); return; }
                const unsub = db.collection('users').doc(user.uid).collection('coupons').onSnapshot(snap => {
                    setMyCoupons(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => unsub();
            }, [user]);
            
            // Points History
            useEffect(() => {
                if (!user) { setPointsHistory([]); return; }
                const unsub = db.collection('users').doc(user.uid).collection('pointsHistory').orderBy('createdAt', 'desc').limit(20).onSnapshot(snap => {
                    setPointsHistory(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => unsub();
            }, [user]);
            
            // Notices
            useEffect(() => {
                const unsub = db.collection('notices').orderBy('createdAt', 'desc').onSnapshot(snap => {
                    setNotices(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => unsub();
            }, []);
            
            // Events
            useEffect(() => {
                const unsub = db.collection('events').orderBy('createdAt', 'desc').onSnapshot(snap => {
                    setEvents(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => unsub();
            }, []);
            
            // Restock Alerts
            useEffect(() => {
                if (!user) { setRestockAlerts([]); return; }
                const unsub = db.collection('restockAlerts').where('userId', '==', user.uid).onSnapshot(snap => {
                    setRestockAlerts(snap.docs.map(d => d.data().productId));
                });
                return () => unsub();
            }, [user]);
            
            // Recent Viewed (localStorage)
            useEffect(() => {
                if (user) {
                    const saved = localStorage.getItem(`recent_${user.uid}`);
                    if (saved) setRecentViewed(JSON.parse(saved));
                }
            }, [user]);
            
            useEffect(() => {
                if (user && recentViewed.length > 0) localStorage.setItem(`recent_${user.uid}`, JSON.stringify(recentViewed));
            }, [recentViewed, user]);
            
            useEffect(() => {
                if (user) localStorage.setItem(`cart_${user.uid}`, JSON.stringify(cart));
            }, [cart, user]);
            
            const register = async (email, password, name, phone) => {
                const { user: firebaseUser } = await auth.createUserWithEmailAndPassword(email, password);
                await db.collection('users').doc(firebaseUser.uid).set({
                    email, name, phone,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    orderCount: 0, totalSpent: 0, points: 1000, wishlist: []
                });
                // 가입 적립금 내역
                await db.collection('users').doc(firebaseUser.uid).collection('pointsHistory').add({
                    amount: 1000, type: 'earn', desc: '회원가입 축하 적립금',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                setUserPoints(1000);
                showToast('회원가입 완료! 1,000P 적립!', 'success');
            };
            
            const login = async (email, password) => {
                await auth.signInWithEmailAndPassword(email, password);
                showToast('로그인 되었습니다', 'success');
            };
            
            const logout = async () => {
                await auth.signOut();
                setCurrentPage('home');
                showToast('로그아웃 되었습니다');
            };
            
            const addToCart = (product, options = {}) => {
                const cartItem = {
                    ...product,
                    cartId: `${product.id}_${options.color || ''}_${options.size || ''}_${Date.now()}`,
                    selectedColor: options.color || '',
                    selectedSize: options.size || '',
                    qty: options.qty || 1
                };
                setCart(prev => [...prev, cartItem]);
                showToast('장바구니에 담았습니다', 'success');
            };
            
            const removeFromCart = (cartId) => setCart(prev => prev.filter(item => item.cartId !== cartId));
            const updateQty = (cartId, qty) => {
                if (qty < 1) return removeFromCart(cartId);
                setCart(prev => prev.map(item => item.cartId === cartId ? {...item, qty} : item));
            };
            const clearCart = () => setCart([]);
            
            const toggleWishlist = async (productId) => {
                if (!user) { showToast('로그인이 필요합니다', 'error'); return; }
                const newWishlist = wishlist.includes(productId) ? wishlist.filter(id => id !== productId) : [...wishlist, productId];
                setWishlist(newWishlist);
                try { await db.collection('users').doc(user.uid).update({ wishlist: newWishlist }); } catch (e) { console.error(e); }
                showToast(wishlist.includes(productId) ? '관심상품에서 삭제했습니다' : '관심상품에 추가했습니다', 'success');
            };
            
            const navigate = (page, product = null) => {
                setCurrentPage(page);
                if (product) {
                    setSelectedProduct(product);
                    addRecentViewed(product);
                }
                window.scrollTo(0, 0);
            };
            
            const addProduct = async (data) => {
                await db.collection('products').add({ ...data, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('상품이 등록되었습니다', 'success');
            };
            
            const updateProduct = async (id, data) => {
                await db.collection('products').doc(id).update(data);
                showToast('상품이 수정되었습니다', 'success');
            };
            
            const deleteProduct = async (id) => {
                await db.collection('products').doc(id).delete();
                showToast('상품이 삭제되었습니다', 'success');
            };
            
            const createOrder = async (orderData) => {
                await db.collection('orders').add({
                    ...orderData,
                    userId: user.uid,
                    userName: user.name,
                    userEmail: user.email,
                    status: 'pending',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                await db.collection('users').doc(user.uid).update({
                    orderCount: firebase.firestore.FieldValue.increment(1),
                    totalSpent: firebase.firestore.FieldValue.increment(orderData.total)
                });
                clearCart();
                setBuyNowItem(null);
                showToast('주문이 완료되었습니다', 'success');
            };
            
            const updateOrderStatus = async (orderId, status) => {
                await db.collection('orders').doc(orderId).update({ status });
                showToast('상태가 변경되었습니다', 'success');
            };
            
            // Q&A 함수
            const addQna = async (data) => {
                await db.collection('qnas').add({
                    ...data,
                    userId: user.uid,
                    userName: user.name,
                    userEmail: user.email,
                    status: 'waiting',
                    answer: '',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                showToast('문의가 등록되었습니다', 'success');
            };
            
            const answerQna = async (id, answer) => {
                await db.collection('qnas').doc(id).update({ answer, status: 'answered', answeredAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('답변이 등록되었습니다', 'success');
            };
            
            const deleteQna = async (id) => {
                await db.collection('qnas').doc(id).delete();
                showToast('삭제되었습니다', 'success');
            };
            
            // Review 함수
            const addReview = async (data) => {
                await db.collection('reviews').add({
                    ...data,
                    userId: user.uid,
                    userName: user.name,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                showToast('후기가 등록되었습니다', 'success');
            };
            
            const deleteReview = async (id) => {
                await db.collection('reviews').doc(id).delete();
                showToast('삭제되었습니다', 'success');
            };
            
            // FAQ 함수
            const addFaq = async (data) => {
                const count = faqs.length;
                await db.collection('faqs').add({ ...data, order: count, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('FAQ가 등록되었습니다', 'success');
            };
            
            const updateFaq = async (id, data) => {
                await db.collection('faqs').doc(id).update(data);
                showToast('FAQ가 수정되었습니다', 'success');
            };
            
            const deleteFaq = async (id) => {
                await db.collection('faqs').doc(id).delete();
                showToast('삭제되었습니다', 'success');
            };
            
            // Site Info 함수
            const updateSiteInfo = async (data) => {
                await db.collection('siteInfo').doc('info').set(data, { merge: true });
                showToast('저장되었습니다', 'success');
            };
            
            // Popup 함수
            const updatePopup = async (data) => {
                await db.collection('siteInfo').doc('popup').set(data, { merge: true });
                showToast('팝업이 저장되었습니다', 'success');
            };
            
            // Coupon 함수
            const addCoupon = async (data) => {
                await db.collection('coupons').add({ ...data, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('쿠폰 등록 완료', 'success');
            };
            const deleteCoupon = async (id) => {
                await db.collection('coupons').doc(id).delete();
                showToast('삭제 완료', 'success');
            };
            const downloadCoupon = async (coupon) => {
                if (!user) { showToast('로그인이 필요합니다', 'error'); return; }
                const exists = myCoupons.find(c => c.couponId === coupon.id);
                if (exists) { showToast('이미 다운받은 쿠폰입니다', 'error'); return; }
                await db.collection('users').doc(user.uid).collection('coupons').add({
                    couponId: coupon.id, name: coupon.name, discount: coupon.discount, minOrder: coupon.minOrder,
                    used: false, downloadedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                showToast('쿠폰 다운로드 완료!', 'success');
            };
            
            // Notice 함수
            const addNotice = async (data) => {
                await db.collection('notices').add({ ...data, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('공지 등록 완료', 'success');
            };
            const deleteNotice = async (id) => {
                await db.collection('notices').doc(id).delete();
                showToast('삭제 완료', 'success');
            };
            
            // Event 함수
            const addEvent = async (data) => {
                await db.collection('events').add({ ...data, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                showToast('이벤트 등록 완료', 'success');
            };
            const deleteEvent = async (id) => {
                await db.collection('events').doc(id).delete();
                showToast('삭제 완료', 'success');
            };
            
            // Restock Alert 함수
            const toggleRestockAlert = async (productId) => {
                if (!user) { showToast('로그인이 필요합니다', 'error'); return; }
                const hasAlert = restockAlerts.includes(productId);
                if (hasAlert) {
                    const snap = await db.collection('restockAlerts').where('userId', '==', user.uid).where('productId', '==', productId).get();
                    snap.forEach(d => d.ref.delete());
                    setRestockAlerts(prev => prev.filter(id => id !== productId));
                    showToast('재입고 알림 해제', 'success');
                } else {
                    await db.collection('restockAlerts').add({ userId: user.uid, productId, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                    setRestockAlerts(prev => [...prev, productId]);
                    showToast('재입고 알림 신청 완료!', 'success');
                }
            };
            
            // Recent Viewed 함수
            const addRecentViewed = (product) => {
                setRecentViewed(prev => {
                    const filtered = prev.filter(p => p.id !== product.id);
                    return [product, ...filtered].slice(0, 10);
                });
            };
            
            // 검색 함수
            const searchProducts = (keyword) => {
                if (!keyword) return products;
                const kw = keyword.toLowerCase();
                return products.filter(p => p.name?.toLowerCase().includes(kw) || p.brand?.toLowerCase().includes(kw));
            };
            
            const getProductsByCategory = (category) => {
                if (category === 'new') return products.slice(0, 20);
                if (category === 'brand') return products;
                return products.filter(p => p.category === category);
            };
            
            return (
                <AppContext.Provider value={{
                    user, isAdmin, loading, register, login, logout,
                    cart, addToCart, removeFromCart, updateQty, clearCart,
                    wishlist, toggleWishlist,
                    currentPage, navigate, selectedProduct,
                    products, addProduct, updateProduct, deleteProduct, getProductsByCategory,
                    orders, allOrders, createOrder, updateOrderStatus, members,
                    showToast, toast, buyNowItem, setBuyNowItem,
                    qnas, addQna, answerQna, deleteQna,
                    reviews, addReview, deleteReview,
                    faqs, addFaq, updateFaq, deleteFaq,
                    siteInfo, updateSiteInfo,
                    popup, updatePopup, defaultPopupImage,
                    searchKeyword, setSearchKeyword, searchProducts,
                    coupons, addCoupon, deleteCoupon, myCoupons, downloadCoupon,
                    userPoints, setUserPoints, pointsHistory,
                    recentViewed, addRecentViewed,
                    notices, addNotice, deleteNotice,
                    events, addEvent, deleteEvent,
                    restockAlerts, toggleRestockAlert,
                    getGrade
                }}>
                    {children}
                </AppContext.Provider>
            );
        };
        
        const useApp = () => useContext(AppContext);
        
        const Toast = () => {
            const { toast } = useApp();
            if (!toast) return null;
            return <div className={`toast ${toast.type}`}>{toast.message}</div>;
        };
        
        const FloatingButtons = () => {
            // 여기에 실제 카카오톡 채널/텔레그램 링크를 입력하세요
            const kakaoLink = 'https://pf.kakao.com/_xYourID'; // 카카오톡 채널 링크
            const telegramLink = 'https://t.me/YourUsername'; // 텔레그램 링크
            
            return (
                <div className="floating-btns">
                    <a href={telegramLink} target="_blank" rel="noopener noreferrer" className="floating-btn telegram" title="텔레그램 문의">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                        </svg>
                    </a>
                    <a href={kakaoLink} target="_blank" rel="noopener noreferrer" className="floating-btn kakao" title="카카오톡 문의">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 3c5.799 0 10.5 3.664 10.5 8.185 0 4.52-4.701 8.184-10.5 8.184a13.5 13.5 0 0 1-1.727-.11l-4.408 2.883c-.501.265-.678.236-.472-.413l.892-3.678c-2.88-1.46-4.785-3.99-4.785-6.866C1.5 6.665 6.201 3 12 3zm5.907 8.06l1.47-1.424a.472.472 0 0 0-.656-.678l-1.928 1.866V9.282a.472.472 0 0 0-.944 0v2.557a.471.471 0 0 0 0 .222V13.5a.472.472 0 0 0 .944 0v-1.363l.427-.413 1.428 2.033a.472.472 0 1 0 .773-.543l-1.514-2.155zm-2.958 1.924h-1.46V9.297a.472.472 0 0 0-.943 0v4.159c0 .26.21.472.471.472h1.932a.472.472 0 1 0 0-.944zm-5.857-1.092l.696-1.707.638 1.707H9.092zm2.523.488l.002-.016a.469.469 0 0 0-.127-.32l-1.046-2.8a.69.69 0 0 0-.627-.474.696.696 0 0 0-.653.447l-1.661 4.075a.472.472 0 0 0 .874.357l.33-.813h2.07l.299.8a.472.472 0 1 0 .884-.33l-.345-.926zm-7.086 1.028l1.078-1.353-1.108-1.39a.472.472 0 1 1 .738-.587l.755.948.73-.947a.472.472 0 1 1 .746.576l-1.093 1.416 1.108 1.389a.472.472 0 0 1-.37.765.47.47 0 0 1-.369-.177l-.772-.97-.77.97a.472.472 0 0 1-.673-.64z"/>
                        </svg>
                    </a>
                </div>
            );
        };
        
        const PopupModal = () => {
            const { popup, navigate, defaultPopupImage } = useApp();
            const [show, setShow] = useState(false);
            
            useEffect(() => {
                if (popup?.active) {
                    const hideUntil = localStorage.getItem('popupHideUntil');
                    if (hideUntil && new Date().getTime() < parseInt(hideUntil)) {
                        setShow(false);
                    } else {
                        setShow(true);
                    }
                }
            }, [popup]);
            
            const handleClose = () => setShow(false);
            
            const handleTodayClose = () => {
                const tomorrow = new Date();
                tomorrow.setHours(23, 59, 59, 999);
                localStorage.setItem('popupHideUntil', tomorrow.getTime().toString());
                setShow(false);
            };
            
            const handleClick = () => {
                if (popup?.link) {
                    if (popup.link.startsWith('http')) {
                        window.open(popup.link, '_blank');
                    } else {
                        navigate(popup.link);
                    }
                }
                setShow(false);
            };
            
            if (!show || !popup?.active) return null;
            
            const imageUrl = popup?.image || defaultPopupImage;
            
            return (
                <div className="popup-overlay">
                    <div className="popup-container">
                        <button className="popup-close" onClick={handleClose}>×</button>
                        <img src={imageUrl} alt="팝업" className="popup-image" onClick={handleClick} />
                        <div className="popup-footer">
                            <label className="popup-today">
                                <input type="checkbox" onChange={handleTodayClose} />
                                오늘 하루 안보기
                            </label>
                            <button className="popup-close-btn" onClick={handleClose}>닫기</button>
                        </div>
                    </div>
                </div>
            );
        };
        
        const LoadingScreen = () => (
            <div className="loading-screen">
                <div className="loading-logo">명동사</div>
                <div className="loading-spinner"></div>
            </div>
        );
        
        const Header = () => {
            const { user, cart, wishlist, navigate, currentPage, isAdmin, setSearchKeyword } = useApp();
            const [localSearch, setLocalSearch] = useState('');
            
            const navItems = [
                { id: 'new', label: '신상품' },
                { id: 'brand', label: '브랜드' },
                { id: 'clothing', label: '의류' },
                { id: 'shoes', label: '신발' },
                { id: 'bags', label: '가방' },
            ];
            
            const handleSearch = () => {
                if (localSearch.trim()) {
                    setSearchKeyword(localSearch.trim());
                    navigate('search');
                }
            };
            
            return (
                <header className="header">
                    <div className="header-top">전 상품 무료배송 | 신규가입 1,000P 적립</div>
                    <div className="header-main">
                        <div className="logo" onClick={() => navigate('home')}>명동사</div>
                        <div className="header-search">
                            <input type="text" placeholder="검색어를 입력하세요" value={localSearch} onChange={e => setLocalSearch(e.target.value)} onKeyPress={e => e.key === 'Enter' && handleSearch()} />
                            <button onClick={handleSearch}>🔍</button>
                        </div>
                        <nav className="nav-menu">
                            {navItems.map(item => (
                                <span key={item.id} className={`nav-link ${currentPage === item.id ? 'active' : ''}`} onClick={() => navigate(item.id)}>{item.label}</span>
                            ))}
                        </nav>
                        <div className="header-actions">
                            {user ? (
                                <>
                                    <span className="header-action" onClick={() => navigate('mypage')}>마이페이지</span>
                                    <span className="header-action" onClick={() => navigate('wishlist')}>
                                        관심 {wishlist.length > 0 && <span className="count">{wishlist.length}</span>}
                                    </span>
                                    {isAdmin && <span className="header-action" onClick={() => navigate('admin')}>관리자</span>}
                                </>
                            ) : (
                                <>
                                    <span className="header-action" onClick={() => navigate('login')}>로그인</span>
                                    <span className="header-action" onClick={() => navigate('register')}>회원가입</span>
                                </>
                            )}
                            <span className="header-action" onClick={() => navigate('cart')}>
                                장바구니 {cart.length > 0 && <span className="count">{cart.length}</span>}
                            </span>
                        </div>
                    </div>
                </header>
            );
        };
        
        const Footer = () => {
            const { navigate } = useApp();
            return (
                <footer className="footer">
                    <div className="footer-content">
                        <div>
                            <div className="footer-brand">명동사</div>
                            <p className="footer-desc">프리미엄 디자이너 셀렉트샵<br/>엄선된 브랜드의 최신 컬렉션</p>
                        </div>
                        <div>
                            <h4 className="footer-title">SHOP</h4>
                            <ul className="footer-links">
                                <li onClick={() => navigate('new')}>신상품</li>
                                <li onClick={() => navigate('clothing')}>의류</li>
                                <li onClick={() => navigate('shoes')}>신발</li>
                                <li onClick={() => navigate('bags')}>가방</li>
                            </ul>
                        </div>
                        <div>
                            <h4 className="footer-title">CS CENTER</h4>
                            <ul className="footer-links">
                                <li onClick={() => navigate('notice')}>공지사항</li>
                                <li onClick={() => navigate('qna')}>Q&A</li>
                                <li onClick={() => navigate('review')}>상품후기</li>
                                <li onClick={() => navigate('faq')}>자주묻는질문</li>
                                <li onClick={() => navigate('event')}>이벤트</li>
                            </ul>
                        </div>
                        <div>
                            <h4 className="footer-title">MY ACCOUNT</h4>
                            <ul className="footer-links">
                                <li onClick={() => navigate('mypage')}>마이페이지</li>
                                <li onClick={() => navigate('wishlist')}>관심상품</li>
                                <li onClick={() => navigate('cart')}>장바구니</li>
                            </ul>
                        </div>
                    </div>
                    <div className="footer-bottom">
                        <span>© 2025 명동사. All rights reserved.</span>
                        <span>개인정보처리방침 | 이용약관</span>
                    </div>
                </footer>
            );
        };
        
        const ProductCard = ({ product }) => {
            const { navigate, wishlist, toggleWishlist } = useApp();
            const isWished = wishlist.includes(product.id);
            const discount = product.salePrice ? Math.round((1 - product.salePrice / product.price) * 100) : 0;
            
            return (
                <div className="product-card">
                    <div className="product-image" onClick={() => navigate('detail', product)}>
                        <img src={product.image} alt={product.name} />
                        {discount > 0 && <span className="product-badge">{discount}%</span>}
                    </div>
                    <button className={`product-wishlist ${isWished ? 'active' : ''}`} onClick={(e) => { e.stopPropagation(); toggleWishlist(product.id); }}>
                        {isWished ? '♥' : '♡'}
                    </button>
                    <div onClick={() => navigate('detail', product)}>
                        <div className="product-brand">{product.brand}</div>
                        <div className="product-name">{product.name}</div>
                        <div className="product-price">
                            {product.salePrice ? (
                                <>
                                    <span className="original">₩{Number(product.price).toLocaleString()}</span>
                                    <span className="sale">₩{Number(product.salePrice).toLocaleString()}</span>
                                </>
                            ) : `₩${Number(product.price).toLocaleString()}`}
                        </div>
                    </div>
                </div>
            );
        };
        
        const HomePage = () => {
            const { navigate, products } = useApp();
            const [currentSlide, setCurrentSlide] = useState(0);
            
            const slides = [
                { image: 'https://images.unsplash.com/photo-1441984904996-e0b6ba687e04?w=1600&q=80', subtitle: '2025 S/S COLLECTION', title: 'NEW ARRIVALS', btn: 'SHOP NOW' },
                { image: 'https://images.unsplash.com/photo-1483985988355-763728e1935b?w=1600&q=80', subtitle: 'SUMMER SALE', title: 'UP TO 50% OFF', btn: 'SALE 보기' },
                { image: 'https://images.unsplash.com/photo-1469334031218-e382a71b716b?w=1600&q=80', subtitle: 'DESIGNER BRAND', title: 'BEST SELLERS', btn: '베스트 보기' },
            ];
            
            useEffect(() => {
                const timer = setInterval(() => {
                    setCurrentSlide(prev => (prev + 1) % slides.length);
                }, 5000);
                return () => clearInterval(timer);
            }, []);
            
            const goToSlide = (index) => setCurrentSlide(index);
            const prevSlide = () => setCurrentSlide(prev => (prev - 1 + slides.length) % slides.length);
            const nextSlide = () => setCurrentSlide(prev => (prev + 1) % slides.length);
            
            return (
                <>
                    <div className="main-slider">
                        <div className="slider-track" style={{ transform: `translateX(-${currentSlide * 100}%)` }}>
                            {slides.map((slide, idx) => (
                                <div key={idx} className="slider-slide">
                                    <img src={slide.image} alt="" />
                                    <div className="slider-content">
                                        <p className="slider-subtitle">{slide.subtitle}</p>
                                        <h1 className="slider-title">{slide.title}</h1>
                                        <button className="btn-white" onClick={() => navigate('new')}>{slide.btn}</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                        <button className="slider-arrow prev" onClick={prevSlide}>‹</button>
                        <button className="slider-arrow next" onClick={nextSlide}>›</button>
                        <div className="slider-dots">
                            {slides.map((_, idx) => (
                                <button key={idx} className={`slider-dot ${currentSlide === idx ? 'active' : ''}`} onClick={() => goToSlide(idx)} />
                            ))}
                        </div>
                    </div>
                    
                    <div className="category-banners">
                        <div className="category-banner" onClick={() => navigate('clothing')}>
                            <img src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=500" alt="" />
                            <div className="category-banner-content"><span className="category-banner-name">의류</span></div>
                        </div>
                        <div className="category-banner" onClick={() => navigate('shoes')}>
                            <img src="https://images.unsplash.com/photo-1460353581641-37baddab0fa2?w=500" alt="" />
                            <div className="category-banner-content"><span className="category-banner-name">신발</span></div>
                        </div>
                        <div className="category-banner" onClick={() => navigate('bags')}>
                            <img src="https://images.unsplash.com/photo-1548036328-c9fa89d128fa?w=500" alt="" />
                            <div className="category-banner-content"><span className="category-banner-name">가방</span></div>
                        </div>
                        <div className="category-banner" onClick={() => navigate('brand')}>
                            <img src="https://images.unsplash.com/photo-1558171813-4c088753af8f?w=500" alt="" />
                            <div className="category-banner-content"><span className="category-banner-name">브랜드</span></div>
                        </div>
                    </div>
                    
                    <section className="section">
                        <div className="section-header">
                            <h2 className="section-title">BEST SELLERS</h2>
                            <span className="section-more" onClick={() => navigate('new')}>더보기 &gt;</span>
                        </div>
                        {products.length > 0 ? (
                            <div className="product-grid">
                                {products.slice(0, 10).map(product => <ProductCard key={product.id} product={product} />)}
                            </div>
                        ) : (
                            <div className="empty-state"><h3>상품 준비 중입니다</h3></div>
                        )}
                    </section>
                    
                    <section className="section">
                        <div className="section-header">
                            <h2 className="section-title">NEW ARRIVALS</h2>
                            <span className="section-more" onClick={() => navigate('new')}>더보기 &gt;</span>
                        </div>
                        {products.length > 0 && (
                            <div className="product-grid">
                                {products.slice(0, 10).map(product => <ProductCard key={product.id} product={product} />)}
                            </div>
                        )}
                    </section>
                </>
            );
        };
        
        const CategoryPage = ({ category }) => {
            const { getProductsByCategory } = useApp();
            const products = getProductsByCategory(category);
            const titles = { new: '신상품', brand: '브랜드', clothing: '의류', shoes: '신발', bags: '가방' };
            
            return (
                <>
                    <div className="list-header">
                        <div className="list-breadcrumb">HOME <span>&gt;</span> {titles[category].toUpperCase()}</div>
                        <h1 className="list-title">{titles[category]}</h1>
                        <div className="list-filter">
                            <div className="list-count">총 <strong>{products.length}</strong>개</div>
                            <div className="list-sort">
                                <select><option>신상품순</option><option>낮은가격순</option><option>높은가격순</option></select>
                            </div>
                        </div>
                    </div>
                    <section className="section">
                        {products.length > 0 ? (
                            <div className="product-grid list-view">{products.map(product => <ProductCard key={product.id} product={product} />)}</div>
                        ) : (
                            <div className="empty-state"><h3>상품이 없습니다</h3></div>
                        )}
                    </section>
                </>
            );
        };
        
        const DetailPage = () => {
            const { selectedProduct, products, addToCart, navigate, wishlist, toggleWishlist, user, setBuyNowItem } = useApp();
            const product = selectedProduct || products[0];
            const [selectedColor, setSelectedColor] = useState('');
            const [selectedSize, setSelectedSize] = useState('');
            const [activeTab, setActiveTab] = useState('desc');
            
            if (!product) return <div className="section empty-state"><h3>상품을 찾을 수 없습니다</h3></div>;
            
            const isWished = wishlist.includes(product.id);
            const colors = product.colors ? product.colors.split(',').map(c => c.trim()) : [];
            const sizes = product.sizes ? product.sizes.split(',').map(s => s.trim()) : [];
            const discount = product.salePrice ? Math.round((1 - product.salePrice / product.price) * 100) : 0;
            
            const handleAddToCart = () => {
                if (colors.length > 0 && !selectedColor) { alert('색상을 선택해주세요'); return; }
                if (sizes.length > 0 && !selectedSize) { alert('사이즈를 선택해주세요'); return; }
                addToCart(product, { color: selectedColor, size: selectedSize });
            };
            
            const handleBuyNow = () => {
                if (!user) { navigate('login'); return; }
                if (colors.length > 0 && !selectedColor) { alert('색상을 선택해주세요'); return; }
                if (sizes.length > 0 && !selectedSize) { alert('사이즈를 선택해주세요'); return; }
                setBuyNowItem({ ...product, selectedColor, selectedSize, qty: 1 });
                navigate('checkout');
            };
            
            return (
                <>
                    <div className="detail-wrap">
                        <div className="detail-container">
                            <div className="detail-images">
                                <div className="detail-main-image"><img src={product.image} alt={product.name} /></div>
                            </div>
                            <div className="detail-info">
                                <div className="detail-brand">{product.brand}</div>
                                <h1 className="detail-name">{product.name}</h1>
                                
                                <div className="detail-price-wrap">
                                    {product.salePrice && <div className="detail-original-price">₩{Number(product.price).toLocaleString()}</div>}
                                    <div className="detail-sale-price">
                                        ₩{Number(product.salePrice || product.price).toLocaleString()}
                                        {discount > 0 && <span className="discount">{discount}%</span>}
                                    </div>
                                </div>
                                
                                {product.shippingInfo && (
                                    <div className="detail-shipping">
                                        <strong>배송</strong> {product.shippingInfo}
                                    </div>
                                )}
                                
                                {colors.length > 0 && (
                                    <div className="option-section">
                                        <span className="option-label">색상</span>
                                        <div className="option-buttons">
                                            {colors.map(color => (
                                                <button key={color} className={`option-btn ${selectedColor === color ? 'active' : ''}`} onClick={() => setSelectedColor(color)}>{color}</button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                
                                {sizes.length > 0 && (
                                    <div className="option-section">
                                        <span className="option-label">사이즈</span>
                                        <div className="option-buttons">
                                            {sizes.map(size => (
                                                <button key={size} className={`option-btn ${selectedSize === size ? 'active' : ''}`} onClick={() => setSelectedSize(size)}>{size}</button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                
                                <div className="detail-actions">
                                    <button className="btn-cart" onClick={handleAddToCart}>장바구니</button>
                                    <button className="btn-buy" onClick={handleBuyNow}>바로구매</button>
                                    <button className={`btn-wish ${isWished ? 'active' : ''}`} onClick={() => toggleWishlist(product.id)}>{isWished ? '♥' : '♡'}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="detail-desc-section">
                        <div className="detail-desc-tabs">
                            <div className={`detail-desc-tab ${activeTab === 'desc' ? 'active' : ''}`} onClick={() => setActiveTab('desc')}>상품상세</div>
                            <div className={`detail-desc-tab ${activeTab === 'review' ? 'active' : ''}`} onClick={() => setActiveTab('review')}>상품후기</div>
                            <div className={`detail-desc-tab ${activeTab === 'qna' ? 'active' : ''}`} onClick={() => setActiveTab('qna')}>Q&A</div>
                        </div>
                        <div className="detail-desc-content">
                            {activeTab === 'desc' && (
                                <div>
                                    {product.shortDesc && <p>{product.shortDesc}</p>}
                                    {product.fullDescription ? (
                                        <div dangerouslySetInnerHTML={{ __html: product.fullDescription.replace(/\n/g, '<br/>') }} />
                                    ) : (
                                        <p>상품 상세 정보가 없습니다.</p>
                                    )}
                                </div>
                            )}
                            {activeTab === 'review' && <div className="empty-state"><h3>등록된 후기가 없습니다</h3></div>}
                            {activeTab === 'qna' && <div className="empty-state"><h3>등록된 문의가 없습니다</h3></div>}
                        </div>
                    </div>
                </>
            );
        };
        
        const LoginPage = () => {
            const { login, navigate } = useApp();
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);
                try {
                    await login(email, password);
                    navigate(email === ADMIN_EMAIL ? 'admin' : 'home');
                } catch (err) { setError('이메일 또는 비밀번호를 확인해주세요'); }
                setLoading(false);
            };
            
            return (
                <div className="auth-page">
                    <div className="auth-container">
                        <h1 className="auth-title">로그인</h1>
                        {error && <div className="auth-error">{error}</div>}
                        <form onSubmit={handleSubmit}>
                            <div className="form-group"><label className="form-label">이메일</label><input type="email" className="form-input" value={email} onChange={(e) => setEmail(e.target.value)} required /></div>
                            <div className="form-group"><label className="form-label">비밀번호</label><input type="password" className="form-input" value={password} onChange={(e) => setPassword(e.target.value)} required /></div>
                            <button type="submit" className="btn-submit" disabled={loading}>{loading ? '로그인 중...' : '로그인'}</button>
                        </form>
                        <p className="auth-link">아직 회원이 아니신가요? <a onClick={() => navigate('register')}>회원가입</a></p>
                    </div>
                </div>
            );
        };
        
        const RegisterPage = () => {
            const { register, navigate } = useApp();
            const [form, setForm] = useState({ name: '', email: '', password: '', phone: '' });
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);
                try {
                    await register(form.email, form.password, form.name, form.phone);
                    navigate('home');
                } catch (err) { setError(err.code === 'auth/email-already-in-use' ? '이미 사용 중인 이메일입니다' : '회원가입에 실패했습니다'); }
                setLoading(false);
            };
            
            return (
                <div className="auth-page">
                    <div className="auth-container">
                        <h1 className="auth-title">회원가입</h1>
                        {error && <div className="auth-error">{error}</div>}
                        <form onSubmit={handleSubmit}>
                            <div className="form-group"><label className="form-label">이름</label><input type="text" className="form-input" value={form.name} onChange={(e) => setForm({...form, name: e.target.value})} required /></div>
                            <div className="form-group"><label className="form-label">이메일</label><input type="email" className="form-input" value={form.email} onChange={(e) => setForm({...form, email: e.target.value})} required /></div>
                            <div className="form-group"><label className="form-label">비밀번호</label><input type="password" className="form-input" value={form.password} onChange={(e) => setForm({...form, password: e.target.value})} required /></div>
                            <div className="form-group"><label className="form-label">연락처</label><input type="tel" className="form-input" value={form.phone} onChange={(e) => setForm({...form, phone: e.target.value})} required /></div>
                            <button type="submit" className="btn-submit" disabled={loading}>{loading ? '가입 중...' : '회원가입'}</button>
                        </form>
                        <p className="auth-link">이미 회원이신가요? <a onClick={() => navigate('login')}>로그인</a></p>
                    </div>
                </div>
            );
        };
        
        const CartPage = () => {
            const { cart, updateQty, removeFromCart, navigate, user } = useApp();
            const total = cart.reduce((sum, item) => sum + (Number(item.salePrice) || Number(item.price)) * item.qty, 0);
            
            if (cart.length === 0) {
                return (
                    <div className="cart-wrap" style={{textAlign: 'center', paddingTop: '80px'}}>
                        <h1 className="cart-title">장바구니</h1>
                        <div className="empty-state"><h3>장바구니가 비어있습니다</h3></div>
                        <button className="btn-buy" style={{marginTop: '20px', padding: '14px 40px'}} onClick={() => navigate('new')}>쇼핑 계속하기</button>
                    </div>
                );
            }
            
            return (
                <div className="cart-wrap">
                    <h1 className="cart-title">장바구니</h1>
                    <div className="cart-layout">
                        <div>
                            <table className="cart-table">
                                <thead>
                                    <tr><th>상품정보</th><th>수량</th><th>가격</th><th>삭제</th></tr>
                                </thead>
                                <tbody>
                                    {cart.map(item => (
                                        <tr key={item.cartId}>
                                            <td>
                                                <div className="cart-product">
                                                    <div className="cart-product-img"><img src={item.image} alt="" /></div>
                                                    <div>
                                                        <div className="cart-product-brand">{item.brand}</div>
                                                        <div className="cart-product-name">{item.name}</div>
                                                        {(item.selectedColor || item.selectedSize) && (
                                                            <div className="cart-product-option">
                                                                {item.selectedColor && `${item.selectedColor}`}
                                                                {item.selectedColor && item.selectedSize && ' / '}
                                                                {item.selectedSize && `${item.selectedSize}`}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div className="cart-qty">
                                                    <button onClick={() => updateQty(item.cartId, item.qty - 1)}>-</button>
                                                    <span>{item.qty}</span>
                                                    <button onClick={() => updateQty(item.cartId, item.qty + 1)}>+</button>
                                                </div>
                                            </td>
                                            <td>₩{((Number(item.salePrice) || Number(item.price)) * item.qty).toLocaleString()}</td>
                                            <td><span className="cart-remove" onClick={() => removeFromCart(item.cartId)}>삭제</span></td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        <div className="cart-summary">
                            <h3>주문 요약</h3>
                            <div className="cart-summary-row"><span>상품금액</span><span>₩{total.toLocaleString()}</span></div>
                            <div className="cart-summary-row"><span>배송비</span><span>무료</span></div>
                            <div className="cart-summary-total"><span>결제예정금액</span><span>₩{total.toLocaleString()}</span></div>
                            <button className="btn-buy" onClick={() => user ? navigate('checkout') : navigate('login')}>
                                {user ? '주문하기' : '로그인 후 주문'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        const CheckoutPage = () => {
            const { cart, user, navigate, createOrder, buyNowItem } = useApp();
            const items = buyNowItem ? [buyNowItem] : cart;
            const total = items.reduce((sum, item) => sum + (Number(item.salePrice) || Number(item.price)) * item.qty, 0);
            const [submitted, setSubmitted] = useState(false);
            const [loading, setLoading] = useState(false);
            const [form, setForm] = useState({ name: user?.name || '', phone: user?.phone || '', address: '', detail: '' });
            
            if (items.length === 0) {
                return <div className="cart-wrap" style={{textAlign: 'center', paddingTop: '80px'}}><div className="empty-state"><h3>주문할 상품이 없습니다</h3></div></div>;
            }
            
            const handleSubmit = async () => {
                if (!form.name || !form.phone || !form.address) { alert('필수 정보를 입력해주세요'); return; }
                setLoading(true);
                try {
                    await createOrder({
                        items: items.map(item => ({
                            id: item.id, brand: item.brand, name: item.name,
                            price: item.price, salePrice: item.salePrice, qty: item.qty, image: item.image,
                            selectedColor: item.selectedColor || '', selectedSize: item.selectedSize || ''
                        })),
                        total,
                        shippingName: form.name,
                        shippingPhone: form.phone,
                        shippingAddress: `${form.address} ${form.detail}`
                    });
                    setSubmitted(true);
                } catch (error) { alert('주문에 실패했습니다'); }
                setLoading(false);
            };
            
            if (submitted) {
                return (
                    <div className="cart-wrap" style={{textAlign: 'center', paddingTop: '80px'}}>
                        <h1 className="cart-title">주문완료</h1>
                        <p style={{color: 'var(--gray-500)', marginBottom: '30px'}}>주문이 완료되었습니다</p>
                        <button className="btn-buy" style={{padding: '14px 40px'}} onClick={() => navigate('mypage')}>주문내역 보기</button>
                    </div>
                );
            }
            
            return (
                <div className="cart-wrap">
                    <h1 className="cart-title">주문하기</h1>
                    <div className="cart-layout">
                        <div>
                            <h3 style={{fontSize: '15px', fontWeight: '700', marginBottom: '20px', paddingBottom: '15px', borderBottom: '2px solid var(--black)'}}>배송정보</h3>
                            <div className="form-group"><label className="form-label">수령인 *</label><input type="text" className="form-input" value={form.name} onChange={(e) => setForm({...form, name: e.target.value})} /></div>
                            <div className="form-group"><label className="form-label">연락처 *</label><input type="tel" className="form-input" value={form.phone} onChange={(e) => setForm({...form, phone: e.target.value})} /></div>
                            <div className="form-group"><label className="form-label">주소 *</label><input type="text" className="form-input" value={form.address} onChange={(e) => setForm({...form, address: e.target.value})} /></div>
                            <div className="form-group"><label className="form-label">상세주소</label><input type="text" className="form-input" value={form.detail} onChange={(e) => setForm({...form, detail: e.target.value})} /></div>
                        </div>
                        <div className="cart-summary">
                            <h3>주문 상품 ({items.length})</h3>
                            {items.map((item, idx) => (
                                <div key={idx} style={{display: 'flex', justifyContent: 'space-between', marginBottom: '10px', fontSize: '13px', color: 'var(--gray-600)'}}>
                                    <span>{item.brand}</span>
                                    <span>₩{((Number(item.salePrice) || Number(item.price)) * item.qty).toLocaleString()}</span>
                                </div>
                            ))}
                            <div className="cart-summary-total"><span>결제예정금액</span><span>₩{total.toLocaleString()}</span></div>
                            <button className="btn-buy" onClick={handleSubmit} disabled={loading}>{loading ? '처리 중...' : '주문하기'}</button>
                        </div>
                    </div>
                </div>
            );
        };
        
        const WishlistPage = () => {
            const { wishlist, products, navigate } = useApp();
            const wishProducts = products.filter(p => wishlist.includes(p.id));
            
            return (
                <>
                    <div className="list-header">
                        <div className="list-breadcrumb">HOME <span>&gt;</span> 관심상품</div>
                        <h1 className="list-title">관심상품</h1>
                        <div className="list-filter"><div className="list-count">총 <strong>{wishProducts.length}</strong>개</div></div>
                    </div>
                    <section className="section">
                        {wishProducts.length > 0 ? (
                            <div className="product-grid list-view">{wishProducts.map(product => <ProductCard key={product.id} product={product} />)}</div>
                        ) : (
                            <div className="empty-state"><h3>관심상품이 없습니다</h3><button className="btn-buy" style={{marginTop:'20px', padding:'14px 40px'}} onClick={() => navigate('new')}>쇼핑하러 가기</button></div>
                        )}
                    </section>
                </>
            );
        };
        
        const MyPage = () => {
            const { user, navigate, orders, logout } = useApp();
            const [tab, setTab] = useState('orders');
            
            if (!user) { navigate('login'); return null; }
            
            const statusText = { pending: '주문확인중', confirmed: '결제완료', shipped: '배송중', completed: '배송완료' };
            
            return (
                <div className="mypage-wrap">
                    <h1 className="mypage-title">마이페이지</h1>
                    <div className="mypage-layout">
                        <div className="mypage-nav">
                            <div className={`mypage-nav-item ${tab === 'orders' ? 'active' : ''}`} onClick={() => setTab('orders')}>주문내역</div>
                            <div className={`mypage-nav-item ${tab === 'profile' ? 'active' : ''}`} onClick={() => setTab('profile')}>내 정보</div>
                            <div className="mypage-nav-item" onClick={() => navigate('wishlist')}>관심상품</div>
                            <div className="mypage-nav-item" onClick={logout}>로그아웃</div>
                        </div>
                        <div className="mypage-content">
                            {tab === 'orders' && (
                                <>
                                    <h2>주문내역</h2>
                                    {orders.length === 0 ? (
                                        <div className="empty-state"><h3>주문내역이 없습니다</h3></div>
                                    ) : (
                                        orders.map(order => (
                                            <div key={order.id} className="order-item">
                                                <div className="order-item-header">
                                                    <span>{order.createdAt?.toDate ? order.createdAt.toDate().toLocaleDateString() : '-'}</span>
                                                    <span className={`status-badge status-${order.status}`}>{statusText[order.status]}</span>
                                                </div>
                                                <div className="order-item-body">
                                                    <p style={{fontSize: '13px', marginBottom: '8px'}}>{order.items?.map(i => `${i.brand} (${i.selectedColor||'-'}/${i.selectedSize||'-'})`).join(', ')}</p>
                                                    <p style={{fontWeight: '600'}}>₩{order.total?.toLocaleString()}</p>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </>
                            )}
                            {tab === 'profile' && (
                                <>
                                    <h2>내 정보</h2>
                                    <div style={{maxWidth: '400px'}}>
                                        <div className="form-group"><label className="form-label">이름</label><input type="text" className="form-input" value={user.name} readOnly /></div>
                                        <div className="form-group"><label className="form-label">이메일</label><input type="email" className="form-input" value={user.email} readOnly /></div>
                                        <div className="form-group"><label className="form-label">연락처</label><input type="tel" className="form-input" value={user.phone || '-'} readOnly /></div>
                                    </div>
                                </>
                            )}
                        </div>
                    </div>
                </div>
            );
        };
        
        // Q&A 페이지 (본인 문의만 보임, 관리자는 전체)
        const QnaPage = () => {
            const { user, qnas, addQna, navigate } = useApp();
            const [showModal, setShowModal] = useState(false);
            const [form, setForm] = useState({ title: '', content: '' });
            
            if (!user) {
                return (
                    <div className="cs-page">
                        <div className="cs-header"><h1>Q&A 문의</h1></div>
                        <div className="cs-content">
                            <div className="empty-state">
                                <h3>로그인이 필요합니다</h3>
                                <p>문의하기는 회원만 이용 가능합니다</p>
                                <button className="btn-buy" style={{marginTop:'20px', padding:'12px 30px'}} onClick={() => navigate('login')}>로그인</button>
                            </div>
                        </div>
                    </div>
                );
            }
            
            const handleSubmit = async () => {
                if (!form.title || !form.content) { alert('제목과 내용을 입력해주세요'); return; }
                await addQna(form);
                setForm({ title: '', content: '' });
                setShowModal(false);
            };
            
            return (
                <div className="cs-page">
                    <div className="cs-header">
                        <h1>Q&A 문의</h1>
                        <p>1:1 문의는 관리자만 확인할 수 있습니다</p>
                    </div>
                    <div className="cs-content">
                        <div className="cs-toolbar">
                            <span>총 {qnas.length}건</span>
                            <button className="btn-buy" style={{padding:'10px 20px'}} onClick={() => setShowModal(true)}>문의하기</button>
                        </div>
                        {qnas.length === 0 ? (
                            <div className="empty-state"><h3>문의 내역이 없습니다</h3></div>
                        ) : (
                            <div className="qna-list">
                                {qnas.map(qna => (
                                    <div key={qna.id} className="qna-item">
                                        <div className="qna-header">
                                            <span className={`qna-status ${qna.status}`}>{qna.status === 'answered' ? '답변완료' : '답변대기'}</span>
                                            <span className="qna-date">{qna.createdAt?.toDate?.().toLocaleDateString() || '-'}</span>
                                        </div>
                                        <h3 className="qna-title">{qna.title}</h3>
                                        <p className="qna-content">{qna.content}</p>
                                        {qna.answer && (
                                            <div className="qna-answer">
                                                <strong>답변</strong>
                                                <p>{qna.answer}</p>
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                    
                    {showModal && (
                        <div className="modal-overlay" onClick={() => setShowModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header"><h2>문의하기</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                                <div className="form-group"><label className="form-label">제목</label><input className="form-input" value={form.title} onChange={e => setForm({...form, title: e.target.value})} /></div>
                                <div className="form-group"><label className="form-label">내용</label><textarea className="form-input" rows="5" value={form.content} onChange={e => setForm({...form, content: e.target.value})}></textarea></div>
                                <button className="btn-submit" onClick={handleSubmit}>등록하기</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // 상품후기 페이지 (전체 공개)
        const ReviewPage = () => {
            const { user, reviews, addReview, products, navigate } = useApp();
            const [showModal, setShowModal] = useState(false);
            const [form, setForm] = useState({ productId: '', title: '', content: '', rating: 5 });
            
            const handleSubmit = async () => {
                if (!form.title || !form.content) { alert('제목과 내용을 입력해주세요'); return; }
                const product = products.find(p => p.id === form.productId);
                await addReview({ ...form, productName: product?.name || '', productBrand: product?.brand || '' });
                setForm({ productId: '', title: '', content: '', rating: 5 });
                setShowModal(false);
            };
            
            return (
                <div className="cs-page">
                    <div className="cs-header">
                        <h1>상품후기</h1>
                        <p>고객님들의 생생한 후기를 확인하세요</p>
                    </div>
                    <div className="cs-content">
                        <div className="cs-toolbar">
                            <span>총 {reviews.length}건</span>
                            {user && <button className="btn-buy" style={{padding:'10px 20px'}} onClick={() => setShowModal(true)}>후기작성</button>}
                        </div>
                        {reviews.length === 0 ? (
                            <div className="empty-state"><h3>등록된 후기가 없습니다</h3></div>
                        ) : (
                            <div className="review-list">
                                {reviews.map(review => (
                                    <div key={review.id} className="review-item">
                                        <div className="review-header">
                                            <div className="review-rating">{'★'.repeat(review.rating)}{'☆'.repeat(5-review.rating)}</div>
                                            <span className="review-date">{review.createdAt?.toDate?.().toLocaleDateString() || '-'}</span>
                                        </div>
                                        <div className="review-product">{review.productBrand} - {review.productName}</div>
                                        <h3 className="review-title">{review.title}</h3>
                                        <p className="review-content">{review.content}</p>
                                        <div className="review-author">{review.userName}</div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                    
                    {showModal && (
                        <div className="modal-overlay" onClick={() => setShowModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header"><h2>후기작성</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                                <div className="form-group">
                                    <label className="form-label">상품 선택</label>
                                    <select className="form-input" value={form.productId} onChange={e => setForm({...form, productId: e.target.value})}>
                                        <option value="">선택하세요</option>
                                        {products.map(p => <option key={p.id} value={p.id}>{p.brand} - {p.name}</option>)}
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label className="form-label">평점</label>
                                    <div className="rating-select">
                                        {[1,2,3,4,5].map(n => (
                                            <span key={n} className={`rating-star ${form.rating >= n ? 'active' : ''}`} onClick={() => setForm({...form, rating: n})}>★</span>
                                        ))}
                                    </div>
                                </div>
                                <div className="form-group"><label className="form-label">제목</label><input className="form-input" value={form.title} onChange={e => setForm({...form, title: e.target.value})} /></div>
                                <div className="form-group"><label className="form-label">내용</label><textarea className="form-input" rows="5" value={form.content} onChange={e => setForm({...form, content: e.target.value})}></textarea></div>
                                <button className="btn-submit" onClick={handleSubmit}>등록하기</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // 배송안내 페이지
        const ShippingPage = () => {
            const { siteInfo } = useApp();
            return (
                <div className="cs-page">
                    <div className="cs-header"><h1>배송안내</h1></div>
                    <div className="cs-content">
                        <div className="info-content" dangerouslySetInnerHTML={{ __html: siteInfo.shipping?.replace(/\n/g, '<br/>') || '<p>배송안내 내용이 없습니다.</p>' }} />
                    </div>
                </div>
            );
        };
        
        // 교환/반품 페이지
        const ExchangePage = () => {
            const { siteInfo } = useApp();
            return (
                <div className="cs-page">
                    <div className="cs-header"><h1>교환/반품</h1></div>
                    <div className="cs-content">
                        <div className="info-content" dangerouslySetInnerHTML={{ __html: siteInfo.exchange?.replace(/\n/g, '<br/>') || '<p>교환/반품 내용이 없습니다.</p>' }} />
                    </div>
                </div>
            );
        };
        
        // 검색 페이지
        const SearchPage = () => {
            const { searchKeyword, searchProducts } = useApp();
            const results = searchProducts(searchKeyword);
            return (
                <>
                    <div className="list-header">
                        <div className="list-breadcrumb">HOME &gt; 검색</div>
                        <h1 className="list-title">"{searchKeyword}" 검색 결과</h1>
                        <div className="list-filter"><div className="list-count">총 <strong>{results.length}</strong>개</div></div>
                    </div>
                    <section className="section">
                        {results.length > 0 ? (
                            <div className="product-grid list-view">{results.map(p => <ProductCard key={p.id} product={p} />)}</div>
                        ) : (
                            <div className="empty-state"><h3>검색 결과가 없습니다</h3><p>다른 검색어로 다시 시도해보세요</p></div>
                        )}
                    </section>
                </>
            );
        };
        
        // 공지사항 페이지
        const NoticePage = () => {
            const { notices } = useApp();
            const [openId, setOpenId] = useState(null);
            return (
                <div className="cs-page">
                    <div className="cs-header"><h1>공지사항</h1></div>
                    <div className="cs-content">
                        {notices.length === 0 ? (
                            <div className="empty-state"><h3>공지사항이 없습니다</h3></div>
                        ) : (
                            <div className="notice-list">
                                {notices.map(n => (
                                    <div key={n.id} className="notice-item" onClick={() => setOpenId(openId === n.id ? null : n.id)}>
                                        <div className="notice-header">
                                            <span className={`notice-badge ${n.important ? 'important' : 'normal'}`}>{n.important ? '중요' : '일반'}</span>
                                            <span className="notice-title">{n.title}</span>
                                        </div>
                                        <div className="notice-date">{n.createdAt?.toDate?.().toLocaleDateString() || '-'}</div>
                                        {openId === n.id && <div className="notice-content">{n.content}</div>}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        // 이벤트 페이지
        const EventPage = () => {
            const { events, navigate } = useApp();
            return (
                <div className="cs-page">
                    <div className="cs-header"><h1>이벤트 / 기획전</h1></div>
                    <div className="cs-content">
                        {events.length === 0 ? (
                            <div className="empty-state"><h3>진행 중인 이벤트가 없습니다</h3></div>
                        ) : (
                            <div className="event-list">
                                {events.map(e => (
                                    <div key={e.id} className="event-item" onClick={() => e.link && navigate(e.link)}>
                                        {e.image && <img src={e.image} alt="" className="event-image" />}
                                        <div className="event-title">{e.title}</div>
                                        <div className="event-period">{e.period}</div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        // 최근 본 상품
        const RecentViewed = () => {
            const { recentViewed, navigate } = useApp();
            if (recentViewed.length === 0) return null;
            return (
                <div className="recent-viewed">
                    <div className="recent-viewed-title">최근본상품</div>
                    <div className="recent-viewed-list">
                        {recentViewed.slice(0, 5).map(p => (
                            <div key={p.id} className="recent-viewed-item" onClick={() => navigate('detail', p)}>
                                <img src={p.image} alt="" />
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        
        // FAQ 페이지
        const FaqPage = () => {
            const { faqs } = useApp();
            const [openId, setOpenId] = useState(null);
            
            return (
                <div className="cs-page">
                    <div className="cs-header">
                        <h1>자주묻는질문</h1>
                        <p>고객님들이 자주 묻는 질문을 모았습니다</p>
                    </div>
                    <div className="cs-content">
                        {faqs.length === 0 ? (
                            <div className="empty-state"><h3>등록된 FAQ가 없습니다</h3></div>
                        ) : (
                            <div className="faq-list">
                                {faqs.map(faq => (
                                    <div key={faq.id} className={`faq-item ${openId === faq.id ? 'open' : ''}`}>
                                        <div className="faq-question" onClick={() => setOpenId(openId === faq.id ? null : faq.id)}>
                                            <span className="faq-q">Q</span>
                                            <span className="faq-title">{faq.question}</span>
                                            <span className="faq-arrow">{openId === faq.id ? '−' : '+'}</span>
                                        </div>
                                        {openId === faq.id && (
                                            <div className="faq-answer">
                                                <span className="faq-a">A</span>
                                                <p>{faq.answer}</p>
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        // 관리자 FAQ 섹션
        const AdminFaqSection = ({ faqs, addFaq, updateFaq, deleteFaq }) => {
            const [showModal, setShowModal] = useState(false);
            const [editingFaq, setEditingFaq] = useState(null);
            const [form, setForm] = useState({ question: '', answer: '' });
            
            const handleNew = () => { setEditingFaq(null); setForm({ question: '', answer: '' }); setShowModal(true); };
            const handleEdit = (faq) => { setEditingFaq(faq); setForm({ question: faq.question, answer: faq.answer }); setShowModal(true); };
            const handleSubmit = async () => {
                if (!form.question || !form.answer) { alert('질문과 답변을 입력해주세요'); return; }
                if (editingFaq) await updateFaq(editingFaq.id, form);
                else await addFaq(form);
                setShowModal(false);
            };
            
            return (
                <div className="admin-table-wrap">
                    <div className="admin-table-header">
                        <h2>FAQ 목록 ({faqs.length})</h2>
                        <button className="btn-admin btn-admin-primary" onClick={handleNew}>+ FAQ 등록</button>
                    </div>
                    <table className="admin-table">
                        <thead><tr><th>질문</th><th>답변</th><th>관리</th></tr></thead>
                        <tbody>
                            {faqs.map(faq => (
                                <tr key={faq.id}>
                                    <td style={{maxWidth:'250px'}}>{faq.question}</td>
                                    <td style={{maxWidth:'350px', fontSize:'13px', color:'#666'}}>{faq.answer?.slice(0,80)}...</td>
                                    <td>
                                        <button className="btn-admin btn-admin-secondary" style={{marginRight:'5px'}} onClick={() => handleEdit(faq)}>수정</button>
                                        <button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteFaq(faq.id); }}>삭제</button>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                    
                    {showModal && (
                        <div className="modal-overlay" onClick={() => setShowModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header"><h2>{editingFaq ? 'FAQ 수정' : 'FAQ 등록'}</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                                <div className="form-group"><label className="form-label">질문</label><input className="form-input" value={form.question} onChange={e => setForm({...form, question: e.target.value})} /></div>
                                <div className="form-group"><label className="form-label">답변</label><textarea className="form-input" rows="5" value={form.answer} onChange={e => setForm({...form, answer: e.target.value})}></textarea></div>
                                <button className="btn-submit" onClick={handleSubmit}>{editingFaq ? '수정' : '등록'}</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // 관리자 안내페이지 섹션
        const AdminSiteInfoSection = ({ siteInfo, updateSiteInfo }) => {
            const [shipping, setShipping] = useState(siteInfo.shipping || '');
            const [exchange, setExchange] = useState(siteInfo.exchange || '');
            
            useEffect(() => {
                setShipping(siteInfo.shipping || '');
                setExchange(siteInfo.exchange || '');
            }, [siteInfo]);
            
            return (
                <div className="admin-siteinfo">
                    <div className="admin-table-wrap" style={{marginBottom:'30px'}}>
                        <div className="admin-table-header"><h2>배송안내</h2></div>
                        <div style={{padding:'20px'}}>
                            <textarea className="form-input" rows="10" value={shipping} onChange={e => setShipping(e.target.value)} placeholder="배송안내 내용을 입력하세요. (줄바꿈 가능)"></textarea>
                            <button className="btn-admin btn-admin-primary" style={{marginTop:'15px'}} onClick={() => updateSiteInfo({ shipping })}>저장</button>
                        </div>
                    </div>
                    <div className="admin-table-wrap">
                        <div className="admin-table-header"><h2>교환/반품</h2></div>
                        <div style={{padding:'20px'}}>
                            <textarea className="form-input" rows="10" value={exchange} onChange={e => setExchange(e.target.value)} placeholder="교환/반품 안내 내용을 입력하세요. (줄바꿈 가능)"></textarea>
                            <button className="btn-admin btn-admin-primary" style={{marginTop:'15px'}} onClick={() => updateSiteInfo({ exchange })}>저장</button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 관리자 쿠폰 관리 섹션
        const AdminCouponSection = ({ coupons, addCoupon, deleteCoupon }) => {
            const [showModal, setShowModal] = useState(false);
            const [form, setForm] = useState({ name: '', discount: '', minOrder: '' });
            
            const handleSubmit = async () => {
                if (!form.name || !form.discount) { alert('쿠폰명과 할인금액을 입력해주세요'); return; }
                await addCoupon({ name: form.name, discount: Number(form.discount), minOrder: Number(form.minOrder) || 0 });
                setShowModal(false);
                setForm({ name: '', discount: '', minOrder: '' });
            };
            
            return (
                <div className="admin-table-wrap">
                    <div className="admin-table-header"><h2>쿠폰 목록 ({coupons.length})</h2><button className="btn-admin btn-admin-primary" onClick={() => setShowModal(true)}>+ 쿠폰 등록</button></div>
                    <table className="admin-table">
                        <thead><tr><th>쿠폰명</th><th>할인금액</th><th>최소주문</th><th>관리</th></tr></thead>
                        <tbody>{coupons.map(c => (
                            <tr key={c.id}><td>{c.name}</td><td>₩{c.discount?.toLocaleString()}</td><td>₩{c.minOrder?.toLocaleString()}</td><td><button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteCoupon(c.id); }}>삭제</button></td></tr>
                        ))}</tbody>
                    </table>
                    {showModal && <div className="modal-overlay" onClick={() => setShowModal(false)}><div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header"><h2>쿠폰 등록</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                        <div className="form-group"><label className="form-label">쿠폰명 *</label><input className="form-input" value={form.name} onChange={e => setForm({...form, name: e.target.value})} /></div>
                        <div className="form-group"><label className="form-label">할인금액 *</label><input type="number" className="form-input" value={form.discount} onChange={e => setForm({...form, discount: e.target.value})} /></div>
                        <div className="form-group"><label className="form-label">최소주문금액</label><input type="number" className="form-input" value={form.minOrder} onChange={e => setForm({...form, minOrder: e.target.value})} /></div>
                        <button className="btn-submit" onClick={handleSubmit}>등록</button>
                    </div></div>}
                </div>
            );
        };
        
        // 관리자 공지사항 관리 섹션
        const AdminNoticeSection = ({ notices, addNotice, deleteNotice }) => {
            const [showModal, setShowModal] = useState(false);
            const [form, setForm] = useState({ title: '', content: '', important: false });
            
            const handleSubmit = async () => {
                if (!form.title || !form.content) { alert('제목과 내용을 입력해주세요'); return; }
                await addNotice(form);
                setShowModal(false);
                setForm({ title: '', content: '', important: false });
            };
            
            return (
                <div className="admin-table-wrap">
                    <div className="admin-table-header"><h2>공지사항 ({notices.length})</h2><button className="btn-admin btn-admin-primary" onClick={() => setShowModal(true)}>+ 공지 등록</button></div>
                    <table className="admin-table">
                        <thead><tr><th>구분</th><th>제목</th><th>날짜</th><th>관리</th></tr></thead>
                        <tbody>{notices.map(n => (
                            <tr key={n.id}><td><span className={`notice-badge ${n.important ? 'important' : 'normal'}`}>{n.important ? '중요' : '일반'}</span></td><td>{n.title}</td><td>{n.createdAt?.toDate?.().toLocaleDateString() || '-'}</td><td><button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteNotice(n.id); }}>삭제</button></td></tr>
                        ))}</tbody>
                    </table>
                    {showModal && <div className="modal-overlay" onClick={() => setShowModal(false)}><div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header"><h2>공지 등록</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                        <div className="form-group"><label style={{display:'flex',alignItems:'center',gap:'8px'}}><input type="checkbox" checked={form.important} onChange={e => setForm({...form, important: e.target.checked})} /> 중요 공지</label></div>
                        <div className="form-group"><label className="form-label">제목 *</label><input className="form-input" value={form.title} onChange={e => setForm({...form, title: e.target.value})} /></div>
                        <div className="form-group"><label className="form-label">내용 *</label><textarea className="form-input" rows="6" value={form.content} onChange={e => setForm({...form, content: e.target.value})}></textarea></div>
                        <button className="btn-submit" onClick={handleSubmit}>등록</button>
                    </div></div>}
                </div>
            );
        };
        
        // 관리자 이벤트 관리 섹션
        const AdminEventSection = ({ events, addEvent, deleteEvent }) => {
            const [showModal, setShowModal] = useState(false);
            const [form, setForm] = useState({ title: '', period: '', image: '', link: '' });
            
            const handleSubmit = async () => {
                if (!form.title) { alert('제목을 입력해주세요'); return; }
                await addEvent(form);
                setShowModal(false);
                setForm({ title: '', period: '', image: '', link: '' });
            };
            
            return (
                <div className="admin-table-wrap">
                    <div className="admin-table-header"><h2>이벤트 ({events.length})</h2><button className="btn-admin btn-admin-primary" onClick={() => setShowModal(true)}>+ 이벤트 등록</button></div>
                    <table className="admin-table">
                        <thead><tr><th>이미지</th><th>제목</th><th>기간</th><th>관리</th></tr></thead>
                        <tbody>{events.map(e => (
                            <tr key={e.id}><td>{e.image && <img src={e.image} alt="" />}</td><td>{e.title}</td><td>{e.period}</td><td><button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteEvent(e.id); }}>삭제</button></td></tr>
                        ))}</tbody>
                    </table>
                    {showModal && <div className="modal-overlay" onClick={() => setShowModal(false)}><div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header"><h2>이벤트 등록</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                        <div className="form-group"><label className="form-label">이미지 URL</label><input className="form-input" value={form.image} onChange={e => setForm({...form, image: e.target.value})} placeholder="https://i.ibb.co/..." /></div>
                        <div className="form-group"><label className="form-label">제목 *</label><input className="form-input" value={form.title} onChange={e => setForm({...form, title: e.target.value})} /></div>
                        <div className="form-group"><label className="form-label">기간</label><input className="form-input" value={form.period} onChange={e => setForm({...form, period: e.target.value})} placeholder="2025.01.01 ~ 2025.01.31" /></div>
                        <div className="form-group"><label className="form-label">링크 (페이지명)</label><input className="form-input" value={form.link} onChange={e => setForm({...form, link: e.target.value})} placeholder="new" /></div>
                        <button className="btn-submit" onClick={handleSubmit}>등록</button>
                    </div></div>}
                </div>
            );
        };
        
        // 관리자 팝업 관리 섹션
        const AdminPopupSection = ({ popup, updatePopup }) => {
            const [active, setActive] = useState(popup?.active || false);
            const [image, setImage] = useState(popup?.image || '');
            const [link, setLink] = useState(popup?.link || '');
            
            useEffect(() => {
                setActive(popup?.active || false);
                setImage(popup?.image || '');
                setLink(popup?.link || '');
            }, [popup]);
            
            const handleSave = () => {
                updatePopup({ active, image, link });
            };
            
            return (
                <div className="admin-table-wrap">
                    <div className="admin-table-header"><h2>팝업 설정</h2></div>
                    <div style={{padding:'25px'}}>
                        <div className="form-group">
                            <label className="form-label" style={{display:'flex', alignItems:'center', gap:'10px'}}>
                                <input type="checkbox" checked={active} onChange={e => setActive(e.target.checked)} style={{width:'18px', height:'18px'}} />
                                팝업 활성화
                            </label>
                            <p style={{fontSize:'12px', color:'#888', marginTop:'5px'}}>체크하면 메인 화면에 팝업이 노출됩니다</p>
                        </div>
                        
                        <div className="form-group" style={{marginTop:'25px'}}>
                            <label className="form-label">팝업 이미지 URL</label>
                            <p style={{fontSize:'12px', color:'#888', marginBottom:'8px'}}>imgbb.com에서 업로드 후 직접링크 (i.ibb.co로 시작) 복사</p>
                            <input className="form-input" value={image} onChange={e => setImage(e.target.value)} placeholder="https://i.ibb.co/xxxxx/popup.jpg" />
                            {image && image.startsWith('http') && (
                                <div style={{marginTop:'15px', padding:'15px', background:'#f5f5f5', borderRadius:'8px'}}>
                                    <p style={{fontSize:'12px', color:'#666', marginBottom:'10px'}}>미리보기:</p>
                                    <img src={image} style={{maxWidth:'300px', maxHeight:'400px', objectFit:'contain', border:'1px solid #ddd'}} />
                                </div>
                            )}
                        </div>
                        
                        <div className="form-group" style={{marginTop:'25px'}}>
                            <label className="form-label">클릭 시 이동할 링크 (선택)</label>
                            <p style={{fontSize:'12px', color:'#888', marginBottom:'8px'}}>페이지 이름 (new, clothing 등) 또는 외부 URL</p>
                            <input className="form-input" value={link} onChange={e => setLink(e.target.value)} placeholder="new 또는 https://example.com" />
                        </div>
                        
                        <button className="btn-submit" style={{marginTop:'30px'}} onClick={handleSave}>저장하기</button>
                        
                        <div style={{marginTop:'40px', padding:'20px', background:'#f9f9f9', borderRadius:'8px'}}>
                            <h4 style={{fontSize:'14px', fontWeight:'600', marginBottom:'15px'}}>💡 팝업 이미지 예시</h4>
                            <p style={{fontSize:'13px', color:'#666', lineHeight:'1.7'}}>
                                권장 사이즈: 400 x 500px (세로형)<br/>
                                파일 형식: JPG, PNG<br/>
                                내용 예시: 세일 안내, 신상품 안내, 이벤트 등
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
        
        const AdminPage = () => {
            const { navigate, logout, products, allOrders, members, addProduct, updateProduct, deleteProduct, updateOrderStatus, qnas, answerQna, deleteQna, faqs, addFaq, updateFaq, deleteFaq, siteInfo, updateSiteInfo, popup, updatePopup, coupons, addCoupon, deleteCoupon, notices, addNotice, deleteNotice, events, addEvent, deleteEvent, getGrade } = useApp();
            const [menu, setMenu] = useState('dashboard');
            const [showModal, setShowModal] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [form, setForm] = useState({ brand: '', name: '', price: '', salePrice: '', category: 'clothing', stock: '', image: '', shortDesc: '', fullDescription: '', shippingInfo: '', colors: '', sizes: '' });
            
            const totalRevenue = allOrders.reduce((sum, o) => sum + (o.total || 0), 0);
            
            const handleEdit = (product) => {
                setEditingProduct(product);
                setForm({ brand: product.brand||'', name: product.name||'', price: product.price||'', salePrice: product.salePrice||'', category: product.category||'clothing', stock: product.stock||'', image: product.image||'', shortDesc: product.shortDesc||'', fullDescription: product.fullDescription||'', shippingInfo: product.shippingInfo||'', colors: product.colors||'', sizes: product.sizes||'' });
                setShowModal(true);
            };
            
            const handleNew = () => {
                setEditingProduct(null);
                setForm({ brand: '', name: '', price: '', salePrice: '', category: 'clothing', stock: '', image: '', shortDesc: '', fullDescription: '', shippingInfo: '', colors: '', sizes: '' });
                setShowModal(true);
            };
            
            const handleSubmit = async () => {
                if (!form.brand || !form.name || !form.price || !form.image) { alert('필수항목을 입력해주세요'); return; }
                try {
                    const data = { brand: form.brand, name: form.name, price: Number(form.price), salePrice: form.salePrice ? Number(form.salePrice) : null, category: form.category, stock: Number(form.stock)||0, image: form.image, shortDesc: form.shortDesc, fullDescription: form.fullDescription, shippingInfo: form.shippingInfo, colors: form.colors, sizes: form.sizes };
                    if (editingProduct) await updateProduct(editingProduct.id, data);
                    else await addProduct(data);
                    setShowModal(false);
                } catch (e) { alert('저장 실패: ' + e.message); }
            };
            
            const statusOptions = [{ value: 'pending', label: '주문확인중' }, { value: 'confirmed', label: '결제완료' }, { value: 'shipped', label: '배송중' }, { value: 'completed', label: '배송완료' }];
            
            return (
                <div className="admin-layout">
                    <aside className="admin-sidebar">
                        <div className="admin-logo">명동사<span>관리자</span></div>
                        <ul className="admin-nav">
                            <li className={`admin-nav-item ${menu === 'dashboard' ? 'active' : ''}`} onClick={() => setMenu('dashboard')}>대시보드</li>
                            <li className={`admin-nav-item ${menu === 'products' ? 'active' : ''}`} onClick={() => setMenu('products')}>상품관리</li>
                            <li className={`admin-nav-item ${menu === 'orders' ? 'active' : ''}`} onClick={() => setMenu('orders')}>주문관리</li>
                            <li className={`admin-nav-item ${menu === 'members' ? 'active' : ''}`} onClick={() => setMenu('members')}>회원관리</li>
                            <li className={`admin-nav-item ${menu === 'qna' ? 'active' : ''}`} onClick={() => setMenu('qna')}>Q&A 관리</li>
                            <li className={`admin-nav-item ${menu === 'faq' ? 'active' : ''}`} onClick={() => setMenu('faq')}>FAQ 관리</li>
                            <li className={`admin-nav-item ${menu === 'coupon' ? 'active' : ''}`} onClick={() => setMenu('coupon')}>쿠폰 관리</li>
                            <li className={`admin-nav-item ${menu === 'notice' ? 'active' : ''}`} onClick={() => setMenu('notice')}>공지사항</li>
                            <li className={`admin-nav-item ${menu === 'event' ? 'active' : ''}`} onClick={() => setMenu('event')}>이벤트</li>
                            <li className={`admin-nav-item ${menu === 'popup' ? 'active' : ''}`} onClick={() => setMenu('popup')}>팝업 관리</li>
                            <li className={`admin-nav-item ${menu === 'siteinfo' ? 'active' : ''}`} onClick={() => setMenu('siteinfo')}>안내페이지</li>
                            <li className="admin-nav-item" onClick={() => navigate('home')}>쇼핑몰</li>
                            <li className="admin-nav-item" onClick={logout}>로그아웃</li>
                        </ul>
                    </aside>
                    <main className="admin-main">
                        <div className="admin-header"><h1>{
                            menu === 'dashboard' ? '대시보드' : 
                            menu === 'products' ? '상품관리' : 
                            menu === 'orders' ? '주문관리' : 
                            menu === 'members' ? '회원관리' :
                            menu === 'qna' ? 'Q&A 관리' :
                            menu === 'faq' ? 'FAQ 관리' :
                            menu === 'coupon' ? '쿠폰 관리' :
                            menu === 'notice' ? '공지사항 관리' :
                            menu === 'event' ? '이벤트 관리' :
                            menu === 'popup' ? '팝업 관리' :
                            menu === 'siteinfo' ? '안내페이지 관리' : ''
                        }</h1></div>
                        <div className="admin-content">
                            {menu === 'dashboard' && (
                                <div className="admin-stats">
                                    <div className="stat-card"><h3>총 주문</h3><div className="value">{allOrders.length}</div></div>
                                    <div className="stat-card"><h3>총 매출</h3><div className="value">₩{(totalRevenue/10000).toFixed(0)}만</div></div>
                                    <div className="stat-card"><h3>대기 주문</h3><div className="value">{allOrders.filter(o=>o.status==='pending').length}</div></div>
                                    <div className="stat-card"><h3>총 회원</h3><div className="value">{members.length}</div></div>
                                </div>
                            )}
                            
                            {menu === 'products' && (
                                <div className="admin-table-wrap">
                                    <div className="admin-table-header">
                                        <h2>상품 목록 ({products.length})</h2>
                                        <button className="btn-admin btn-admin-primary" onClick={handleNew}>+ 상품등록</button>
                                    </div>
                                    <table className="admin-table">
                                        <thead><tr><th>이미지</th><th>브랜드</th><th>상품명</th><th>가격</th><th>옵션</th><th>관리</th></tr></thead>
                                        <tbody>
                                            {products.map(p => (
                                                <tr key={p.id}>
                                                    <td><img src={p.image} alt="" /></td>
                                                    <td>{p.brand}</td>
                                                    <td>{p.name}</td>
                                                    <td>{p.salePrice ? <><s style={{color:'#999'}}>₩{Number(p.price).toLocaleString()}</s><br/>₩{Number(p.salePrice).toLocaleString()}</> : `₩${Number(p.price).toLocaleString()}`}</td>
                                                    <td style={{fontSize:'11px'}}>{p.colors||'-'}<br/>{p.sizes||'-'}</td>
                                                    <td>
                                                        <button className="btn-admin btn-admin-secondary" style={{marginRight:'5px'}} onClick={() => handleEdit(p)}>수정</button>
                                                        <button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteProduct(p.id); }}>삭제</button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    
                                    {showModal && (
                                        <div className="modal-overlay" onClick={() => setShowModal(false)}>
                                            <div className="modal" onClick={e => e.stopPropagation()}>
                                                <div className="modal-header"><h2>{editingProduct ? '상품수정' : '상품등록'}</h2><span className="modal-close" onClick={() => setShowModal(false)}>×</span></div>
                                                <div className="form-group">
                                                    <label className="form-label">이미지 URL *</label>
                                                    <p style={{fontSize:'11px',color:'#888',marginBottom:'6px'}}>imgbb.com → 업로드 → 직접링크 (i.ibb.co로 시작) 복사</p>
                                                    <input className="form-input" value={form.image} onChange={e => setForm({...form, image: e.target.value})} />
                                                    {form.image && form.image.startsWith('http') && <img src={form.image} className="image-preview" style={{marginTop:'10px'}} />}
                                                </div>
                                                <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'10px'}}>
                                                    <div className="form-group"><label className="form-label">브랜드 *</label><input className="form-input" value={form.brand} onChange={e => setForm({...form, brand: e.target.value})} /></div>
                                                    <div className="form-group"><label className="form-label">카테고리</label><select className="form-input" value={form.category} onChange={e => setForm({...form, category: e.target.value})}><option value="clothing">의류</option><option value="shoes">신발</option><option value="bags">가방</option></select></div>
                                                </div>
                                                <div className="form-group"><label className="form-label">상품명 *</label><input className="form-input" value={form.name} onChange={e => setForm({...form, name: e.target.value})} /></div>
                                                <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'10px'}}>
                                                    <div className="form-group"><label className="form-label">정가 *</label><input type="number" className="form-input" value={form.price} onChange={e => setForm({...form, price: e.target.value})} /></div>
                                                    <div className="form-group"><label className="form-label">할인가</label><input type="number" className="form-input" value={form.salePrice} onChange={e => setForm({...form, salePrice: e.target.value})} /></div>
                                                </div>
                                                <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'10px'}}>
                                                    <div className="form-group"><label className="form-label">색상 (쉼표구분)</label><input className="form-input" placeholder="블랙, 화이트" value={form.colors} onChange={e => setForm({...form, colors: e.target.value})} /></div>
                                                    <div className="form-group"><label className="form-label">사이즈 (쉼표구분)</label><input className="form-input" placeholder="S, M, L, XL" value={form.sizes} onChange={e => setForm({...form, sizes: e.target.value})} /></div>
                                                </div>
                                                <div className="form-group"><label className="form-label">배송정보</label><input className="form-input" placeholder="무료배송, 2-3일 소요" value={form.shippingInfo} onChange={e => setForm({...form, shippingInfo: e.target.value})} /></div>
                                                <div className="form-group"><label className="form-label">간단설명</label><textarea className="form-input" rows="2" value={form.shortDesc} onChange={e => setForm({...form, shortDesc: e.target.value})}></textarea></div>
                                                <div className="form-group"><label className="form-label">상세설명</label><textarea className="form-input" rows="5" value={form.fullDescription} onChange={e => setForm({...form, fullDescription: e.target.value})}></textarea></div>
                                                <button type="button" className="btn-submit" onClick={handleSubmit}>{editingProduct ? '수정' : '등록'}</button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                            
                            {menu === 'orders' && (
                                <div className="admin-table-wrap">
                                    <div className="admin-table-header"><h2>주문 목록 ({allOrders.length})</h2></div>
                                    <table className="admin-table">
                                        <thead><tr><th>주문번호</th><th>고객</th><th>상품</th><th>옵션</th><th>금액</th><th>날짜</th><th>상태</th></tr></thead>
                                        <tbody>
                                            {allOrders.map(order => (
                                                <tr key={order.id}>
                                                    <td>{order.id.slice(0,8).toUpperCase()}</td>
                                                    <td>{order.userName}<br/><small style={{color:'#999'}}>{order.shippingPhone}</small></td>
                                                    <td>{order.items?.map(i => i.brand).join(', ')}</td>
                                                    <td style={{fontSize:'11px'}}>{order.items?.map(i => `${i.selectedColor||'-'}/${i.selectedSize||'-'}`).join(', ')}</td>
                                                    <td>₩{order.total?.toLocaleString()}</td>
                                                    <td>{order.createdAt?.toDate ? order.createdAt.toDate().toLocaleDateString() : '-'}</td>
                                                    <td><select value={order.status} onChange={e => updateOrderStatus(order.id, e.target.value)} style={{padding:'5px',border:'1px solid #ddd',fontSize:'12px'}}>{statusOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}</select></td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            )}
                            
                            {menu === 'members' && (
                                <div className="admin-table-wrap">
                                    <div className="admin-table-header"><h2>회원 목록 ({members.length})</h2></div>
                                    <table className="admin-table">
                                        <thead><tr><th>이름</th><th>이메일</th><th>연락처</th><th>가입일</th><th>주문수</th><th>구매액</th></tr></thead>
                                        <tbody>
                                            {members.map(m => (
                                                <tr key={m.id}>
                                                    <td>{m.name}</td>
                                                    <td>{m.email}</td>
                                                    <td>{m.phone||'-'}</td>
                                                    <td>{m.createdAt?.toDate ? m.createdAt.toDate().toLocaleDateString() : '-'}</td>
                                                    <td>{m.orderCount||0}</td>
                                                    <td>₩{(m.totalSpent||0).toLocaleString()}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            )}
                            
                            {menu === 'qna' && (
                                <div className="admin-table-wrap">
                                    <div className="admin-table-header"><h2>Q&A 목록 ({qnas.length})</h2></div>
                                    <table className="admin-table">
                                        <thead><tr><th>상태</th><th>제목</th><th>작성자</th><th>날짜</th><th>관리</th></tr></thead>
                                        <tbody>
                                            {qnas.map(qna => (
                                                <tr key={qna.id}>
                                                    <td><span className={`status-badge status-${qna.status === 'answered' ? 'completed' : 'pending'}`}>{qna.status === 'answered' ? '답변완료' : '답변대기'}</span></td>
                                                    <td style={{maxWidth:'200px'}}>
                                                        <strong>{qna.title}</strong>
                                                        <p style={{fontSize:'12px', color:'#888', marginTop:'5px'}}>{qna.content?.slice(0,50)}...</p>
                                                        {qna.answer && <p style={{fontSize:'12px', color:'#1976d2', marginTop:'5px'}}>↳ {qna.answer?.slice(0,30)}...</p>}
                                                    </td>
                                                    <td>{qna.userName}<br/><small style={{color:'#999'}}>{qna.userEmail}</small></td>
                                                    <td>{qna.createdAt?.toDate?.().toLocaleDateString() || '-'}</td>
                                                    <td>
                                                        <button className="btn-admin btn-admin-primary" style={{marginRight:'5px'}} onClick={() => {
                                                            const answer = prompt('답변을 입력하세요:', qna.answer || '');
                                                            if (answer !== null) answerQna(qna.id, answer);
                                                        }}>답변</button>
                                                        <button className="btn-admin btn-admin-danger" onClick={() => { if(window.confirm('삭제?')) deleteQna(qna.id); }}>삭제</button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            )}
                            
                            {menu === 'faq' && (
                                <AdminFaqSection faqs={faqs} addFaq={addFaq} updateFaq={updateFaq} deleteFaq={deleteFaq} />
                            )}
                            
                            {menu === 'coupon' && (
                                <AdminCouponSection coupons={coupons} addCoupon={addCoupon} deleteCoupon={deleteCoupon} />
                            )}
                            
                            {menu === 'notice' && (
                                <AdminNoticeSection notices={notices} addNotice={addNotice} deleteNotice={deleteNotice} />
                            )}
                            
                            {menu === 'event' && (
                                <AdminEventSection events={events} addEvent={addEvent} deleteEvent={deleteEvent} />
                            )}
                            
                            {menu === 'popup' && (
                                <AdminPopupSection popup={popup} updatePopup={updatePopup} />
                            )}
                            
                            {menu === 'siteinfo' && (
                                <AdminSiteInfoSection siteInfo={siteInfo} updateSiteInfo={updateSiteInfo} />
                            )}
                        </div>
                    </main>
                </div>
            );
        };
        
        const Router = () => {
            const { currentPage, isAdmin, loading } = useApp();
            if (loading) return <LoadingScreen />;
            if (currentPage === 'admin' && isAdmin) return <AdminPage />;
            
            const categoryPages = ['new', 'brand', 'clothing', 'shoes', 'bags'];
            const pages = { 
                home: <HomePage />, 
                login: <LoginPage />, 
                register: <RegisterPage />, 
                detail: <DetailPage />, 
                cart: <CartPage />, 
                checkout: <CheckoutPage />, 
                wishlist: <WishlistPage />, 
                mypage: <MyPage />,
                qna: <QnaPage />,
                review: <ReviewPage />,
                shipping: <ShippingPage />,
                exchange: <ExchangePage />,
                faq: <FaqPage />,
                search: <SearchPage />,
                notice: <NoticePage />,
                event: <EventPage />
            };
            
            let content;
            if (categoryPages.includes(currentPage)) content = <CategoryPage category={currentPage} />;
            else content = pages[currentPage] || <HomePage />;
            
            return (<><Header /><main>{content}</main><Footer /><RecentViewed /></>);
        };
        
        const App = () => (<AppProvider><Router /><Toast /><FloatingButtons /><PopupModal /></AppProvider>);
        
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
